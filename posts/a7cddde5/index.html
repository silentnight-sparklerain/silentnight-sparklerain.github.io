<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>计算机组成原理（2）：计算机系统的硬件结构 | 北城烟雨阁</title><meta name="author" content="寂夜璃殇情"><meta name="copyright" content="寂夜璃殇情"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="计算机组成原理第二部分：计算机系统的硬件结构">
<meta property="og:type" content="article">
<meta property="og:title" content="计算机组成原理（2）：计算机系统的硬件结构">
<meta property="og:url" content="https://www.sparklerain.top/posts/a7cddde5/index.html">
<meta property="og:site_name" content="北城烟雨阁">
<meta property="og:description" content="计算机组成原理第二部分：计算机系统的硬件结构">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://www.sparklerain.top/img/posts/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86.jpg">
<meta property="article:published_time" content="2025-12-19T16:00:00.000Z">
<meta property="article:modified_time" content="2025-12-19T16:00:00.000Z">
<meta property="article:author" content="寂夜璃殇情">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.sparklerain.top/img/posts/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "计算机组成原理（2）：计算机系统的硬件结构",
  "url": "https://www.sparklerain.top/posts/a7cddde5/",
  "image": "https://www.sparklerain.top/img/posts/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86.jpg",
  "datePublished": "2025-12-19T16:00:00.000Z",
  "dateModified": "2025-12-19T16:00:00.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "寂夜璃殇情",
      "url": "https://www.sparklerain.top"
    }
  ]
}</script><link rel="shortcut icon" href="/img/Profile_Picture.jpg"><link rel="canonical" href="https://www.sparklerain.top/posts/a7cddde5/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.2"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!true && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '计算机组成原理（2）：计算机系统的硬件结构',
  isHighlightShrink: true,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/custom.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css" media="print" onload="this.media='all'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 8.1.1"></head><body><div id="web_bg" style="background-image: url(/img/Aurora.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/Profile_Picture.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">18</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-th-large"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-info-circle"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fas fa-envelope-open"></i><span> 留言板</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 列表</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/tools/"><i class="fa-fw fas fa-cogs"></i><span> 工具</span></a></li><li><a class="site-page child" href="/projects/"><i class="fa-fw fas fa-project-diagram"></i><span> 项目</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image: url(/img/posts/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">北城烟雨阁</span></a><a class="nav-page-title" href="/"><span class="site-name">计算机组成原理（2）：计算机系统的硬件结构</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-th-large"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-info-circle"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fas fa-envelope-open"></i><span> 留言板</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 列表</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/tools/"><i class="fa-fw fas fa-cogs"></i><span> 工具</span></a></li><li><a class="site-page child" href="/projects/"><i class="fa-fw fas fa-project-diagram"></i><span> 项目</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">计算机组成原理（2）：计算机系统的硬件结构</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-12-19T16:00:00.000Z" title="发表于 2025-12-20 00:00:00">2025-12-20</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-12-19T16:00:00.000Z" title="更新于 2025-12-20 00:00:00">2025-12-20</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Programming/">Programming</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Programming/Theory/">Theory</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">15.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>49分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><div id="post-outdate-notice" data="{&quot;limitDay&quot;:365,&quot;messagePrev&quot;:&quot;It has been&quot;,&quot;messageNext&quot;:&quot;days since the last update, the content of the article may be outdated.&quot;,&quot;postUpdate&quot;:&quot;2025-12-20 00:00:00&quot;}" hidden></div><h2 id="第3章-系统总线">第3章 系统总线</h2>
<p>本章重点介绍计算机各部件如何连接在一起，以及它们之间如何协调通信。</p>
<h3 id="3-1-总线的基本概念">3.1 总线的基本概念</h3>
<p><strong>1. 为什么要用总线？</strong></p>
<ul>
<li><strong>分散连接（早期方式）</strong>：各部件之间两两用单独的线连接。
<ul>
<li><em>缺点</em>：连线极其复杂。如果想加一个新的I/O设备（比如打印机），很难连接，因为原来的线是固定的。且早期结构以运算器为中心，I/O传输数据时会打断CPU运算。</li>
</ul>
</li>
<li><strong>总线连接（现代方式）</strong>：将各部件连到一组<strong>公共</strong>的信息传输线上。
<ul>
<li><em>优点</em>：结构清晰，扩展性好（想加设备直接挂在总线上即可）。</li>
</ul>
</li>
</ul>
<p><strong>2. 什么是总线？</strong></p>
<ul>
<li><strong>定义</strong>：总线是连接多个部件的信息传输线，是各部件<strong>共享</strong>的传输介质。</li>
<li><strong>核心规则</strong>：
<ul>
<li><strong>发送</strong>：在某一个时刻，<strong>只允许有一个</strong>部件向总线发送信息（否则信号会冲突）。</li>
<li><strong>接收</strong>：多个部件可以同时从总线上接收相同的信息。</li>
</ul>
</li>
<li><strong>物理形态</strong>：总线由许多传输线组成。16条传输线就可以同时传输16位二进制代码（并行传输）。</li>
</ul>
<p><strong>3. 总线结构的演变</strong></p>
<ul>
<li><strong>面向CPU的双总线结构</strong>：
<ul>
<li><strong>M总线</strong>：连接CPU和主存。</li>
<li><strong>I/O总线</strong>：连接CPU和I/O设备。</li>
<li><em>缺点</em>：I/O设备和主存交换数据必须经过CPU，CPU成了“搬运工”，效率低。</li>
</ul>
</li>
</ul>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/post_article/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/3-1.png" alt="图 3.1 面向CPU的双总线结构框图"></p>
<blockquote>
<ul>
<li><strong>描述</strong>：CPU处于顶端，向左下方伸出一组“M总线”连接主存，向右下方伸出一组“I/O总线”连接多个I/O接口。I/O设备挂在接口下方。</li>
</ul>
</blockquote>
<ul>
<li><strong>单总线结构</strong>：
<ul>
<li>CPU、主存、I/O设备都挂在同一组总线上。</li>
<li><em>优点</em>：I/O设备和主存可以直接交换信息，不需要CPU干预（前提是支持DMA）。</li>
<li><em>缺点</em>：只有一条路，大家都要走，容易堵车（争用总线）。</li>
</ul>
</li>
</ul>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/post_article/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/3-2.png" alt="图 3.2 单总线结构框图"></p>
<blockquote>
<ul>
<li><strong>描述</strong>：一条横向的“单总线（系统总线）”。CPU、主存、I/O接口都并排挂在这条线上。</li>
</ul>
</blockquote>
<ul>
<li><strong>以存储器为中心的双总线结构</strong>：
<ul>
<li>在单总线基础上，在CPU和主存之间单独开辟一条“<strong>存储总线</strong>”。</li>
<li><em>优点</em>：CPU读写内存时不占用系统总线，减轻了负担，速度更快。</li>
</ul>
</li>
</ul>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/post_article/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/3-3.png" alt="图 3.3 以存储器为中心的双总线结构框图"></p>
<blockquote>
<ul>
<li><strong>描述</strong>：主存位于中心位置。左边通过“存储总线”单独连CPU，上方通过“系统总线”连各种I/O接口。</li>
</ul>
</blockquote>
<h3 id="3-2-总线的分类">3.2 总线的分类</h3>
<p>按连接部件不同，分为三类：</p>
<h4 id="3-2-1-片内总线">3.2.1 片内总线</h4>
<ul>
<li><strong>定义</strong>：指<strong>芯片内部</strong>的总线。</li>
<li><strong>位置</strong>：在CPU芯片里面，连接寄存器与寄存器、寄存器与ALU（算术逻辑单元）。</li>
</ul>
<h4 id="3-2-2-系统总线">3.2.2 系统总线</h4>
<ul>
<li><strong>定义</strong>：连接CPU、主存、I/O设备各大部件之间的信息传输线。通常指计算机主板上的总线（板级总线）。</li>
<li><strong>按传输内容分类</strong>（非常重要）：
<ol>
<li><strong>数据总线 (Data Bus)</strong>：
<ul>
<li><strong>作用</strong>：传输数据信息。</li>
<li><strong>方向</strong>：<strong>双向</strong>传输（CPU既要读数据也要写数据）。</li>
<li><strong>位数</strong>：称为<strong>数据总线宽度</strong>。通常与机器字长或存储字长有关（如32位、64位）。它是衡量系统性能的重要参数。</li>
</ul>
</li>
<li><strong>地址总线 (Address Bus)</strong>：
<ul>
<li><strong>作用</strong>：指出数据在哪里（源地址或目的地址）。</li>
<li><strong>方向</strong>：<strong>单向</strong>传输（由CPU发出，指向存储器或I/O端口）。</li>
<li><strong>位数</strong>：决定了<strong>寻址能力</strong>。例如20根地址线，能访问 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>20</mn></msup><mo>=</mo><mn>1</mn><mtext>M</mtext></mrow><annotation encoding="application/x-tex">2^{20} = 1\text{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord text"><span class="mord">M</span></span></span></span></span> 个单元。</li>
</ul>
</li>
<li><strong>控制总线 (Control Bus)</strong>：
<ul>
<li><strong>作用</strong>：发出各种控制信号，协调各部件工作。</li>
<li><strong>方向</strong>：对单根线通常是单向的，但作为整体是<strong>双向</strong>的（既有CPU发出的命令，也有设备反馈的状态）。</li>
<li><strong>信号举例</strong>：时钟、复位、总线请求、总线允许、存储器读/写、中断请求等。</li>
</ul>
</li>
</ol>
</li>
</ul>
<h4 id="3-2-3-通信总线">3.2.3 通信总线</h4>
<ul>
<li><strong>定义</strong>：用于计算机系统之间，或计算机与其他系统（如仪表）之间的通信。</li>
<li><strong>按传输方式分类</strong>：
<ol>
<li><strong>串行通信</strong>：
<ul>
<li><strong>特点</strong>：数据在单条线上，一位一位地按顺序传送。</li>
<li><strong>适用</strong>：远距离传输（省线、省钱）。</li>
</ul>
</li>
<li><strong>并行通信</strong>：
<ul>
<li><strong>特点</strong>：数据在多条线上同时传送（如8位一起传）。</li>
<li><strong>适用</strong>：近距离传输（速度快，但线多、贵，且距离远了容易产生干扰）。</li>
</ul>
</li>
</ol>
</li>
</ul>
<h3 id="3-3-总线特性及性能指标">3.3 总线特性及性能指标</h3>
<h4 id="3-3-1-总线特性">3.3.1 总线特性</h4>
<p>为了让不同厂家的板卡能插在一起工作，总线必须有统一的特性：</p>
<ol>
<li><strong>机械特性</strong>：插头、插座的尺寸、形状、引脚排列顺序。（物理尺寸）</li>
<li><strong>电气特性</strong>：传输线上信号的传递方向 和有效的 电平 范围。
<ul>
<li>输出信号：CPU发出的信号。</li>
<li>输入信号：输入CPU的信号。
<ul>
<li>地址总线：单向输出线，高电平为1，低电平为0。</li>
<li>数据总线：双向传输线，高电平为1，低电平为0。</li>
<li>控制总线：每一个为单向，但整体有输入和输出，高电平/低电平有效。</li>
</ul>
</li>
</ul>
</li>
<li><strong>功能特性</strong>：每根传输线的功能。
<ul>
<li>地址总线：传输地址码。</li>
<li>数据总线：传输数据信息。</li>
<li>控制总线：传输控制信号。</li>
</ul>
</li>
<li><strong>时间特性</strong>：总线上的各种信号间的<strong>时序</strong>关系：总线中的任一根线在什么时间内有效。</li>
</ol>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/post_article/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/3-3.png" alt="图 3.3 总线结构的物理实现"></p>
<blockquote>
<ul>
<li><strong>描述</strong>：展示了主板（底板）上有许多平行的插槽，CPU插板、主存插板、I/O插板都垂直插入这些槽中。插槽背后的印刷电路连线就是总线。</li>
</ul>
</blockquote>
<h4 id="3-3-2-总线性能指标">3.3.2 总线性能指标</h4>
<ol>
<li><strong>总线宽度</strong>：数据总线的根数（位宽）。如32位、64位。</li>
<li><strong>总线带宽</strong>：<strong>单位时间内</strong>总线上传输数据的位数。通常用MBps（兆字节每秒）表示。
<ul>
<li><strong>公式</strong>：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>总线带宽</mtext><mo>=</mo><mtext>总线工作频率</mtext><mo>×</mo><mo stretchy="false">(</mo><mtext>总线宽度</mtext><mi mathvariant="normal">/</mi><mn>8</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{总线带宽} = \text{总线工作频率} \times (\text{总线宽度}/8)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord text"><span class="mord cjk_fallback">总线带宽</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord text"><span class="mord cjk_fallback">总线工作频率</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord text"><span class="mord cjk_fallback">总线宽度</span></span><span class="mord">/</span><span class="mord">8</span><span class="mclose">)</span></span></span></span>。</li>
</ul>
</li>
<li><strong>时钟同步/异步</strong>：
<ul>
<li><strong>同步总线</strong>：数据传输跟着统一的时钟节奏走。</li>
<li><strong>异步总线</strong>：没有统一时钟，靠互相发信号来协调。</li>
</ul>
</li>
<li><strong>总线复用</strong>：一条信号线上分时传送两种信号（如地址线和数据线共用物理线路，先传地址，后传数据），为了减少引脚数。</li>
<li><strong>信号线数</strong>：地址线、数据线、控制线总和。</li>
<li><strong>总线控制方式</strong>：突发工作、自动配置、仲裁方式等。</li>
<li><strong>负载能力</strong>：总线能驱动多少个设备。</li>
</ol>
<h4 id="3-3-3-总线标准">3.3.3 总线标准</h4>
<ul>
<li><strong>概念</strong>：所谓总线标准，就是一套大家公认的连接规则。只要按标准设计，不同厂家的显卡、网卡都能插在同一块主板上。</li>
<li><strong>常见的总线标准</strong>：
<ol>
<li><strong>ISA 总线</strong>：早期标准，16位，速度慢，CPU要亲自参与控制，效率低。</li>
<li><strong>EISA 总线</strong>：ISA的扩展，32位，兼容ISA。</li>
<li><strong>VESA (VL-BUS) 总线</strong>：局部总线标准，直接挂在CPU上，速度快，主要用于早期的显卡。但负载能力差（只能挂一两个设备）。</li>
<li><strong>PCI 总线</strong>（重要）：
<ul>
<li>不依附于具体处理器的局部总线。</li>
<li>有<strong>PCI桥</strong>（控制器）作为中间层，将高速设备和CPU隔开，互不干扰。</li>
<li>支持<strong>即插即用</strong> (Plug and Play)。</li>
<li>支持<strong>突发工作</strong>方式（给一次地址，传一堆数据）。</li>
</ul>
</li>
<li><strong>AGP 总线</strong>：专门为了解决3D图形数据量大、PCI带宽不够的问题而设计的<strong>显卡专用接口</strong>。</li>
<li><strong>RS-232C 总线</strong>：串行通信接口标准。
<ul>
<li>用于连接“数据终端设备(DTE)”和“数据通信设备(DCE，如调制解调器)”。</li>
<li><em>注意</em>：它的电平标准和计算机内部（TTL）不一样，连接时需要电平转换。</li>
</ul>
</li>
<li><strong>USB 总线</strong> (通用串行总线)：
<ul>
<li><strong>特点</strong>：即插即用、支持热插拔（不关机就能插拔）、连接能力强（通过集线器HUB可以连127个设备）。</li>
<li><strong>供电</strong>：线缆中包含电源线，可直接对外设供电。</li>
<li><strong>结构</strong>：通过HUB形成树状/星型结构。</li>
</ul>
</li>
</ol>
</li>
</ul>
<h3 id="3-4-总线结构">3.4 总线结构</h3>
<p>随着速度要求提高，总线结构越来越复杂。</p>
<h4 id="3-4-1-单总线结构">3.4.1 单总线结构</h4>
<ul>
<li>将计算机当中的所有部件都连接到一组总线（系统总线）上。</li>
<li>缺点：任何时刻只能有一个部件占用总线，总线成为系统的性能瓶颈。</li>
</ul>
<h4 id="3-4-2-多总线结构">3.4.2 多总线结构</h4>
<ol>
<li><strong>以CPU为中心的双总线结构</strong>：
<ul>
<li>存储总线（M总线）：连接CPU和主存。</li>
<li>输入输出总线（I/O总线）：连接CPU和各I/O设备。</li>
<li>CPU和主存间有专用的M总线，有利于提高CPU的工作效率。</li>
<li>缺点：I/O设备在与主存交换信息时，需占用CPU。</li>
</ul>
</li>
</ol>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/post_article/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/3-6.png" alt="图 3.6 以CPU为中心的双总线结构"></p>
<ol start="2">
<li><strong>以存储器为中心的双总线结构</strong>：
<ul>
<li>I/O设备与主存交换信息时，无需经过CPU。</li>
</ul>
</li>
</ol>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/post_article/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/3-7.png" alt="图 3.7 以存储器为中心的双总线结构"></p>
<ol start="3">
<li><strong>三总线结构</strong>：
<ul>
<li>双总线结构高速外设和低速外设共用总线，会影响其工作效率。</li>
<li><strong>主存总线</strong>：CPU和主存之间。</li>
<li><strong>I/O总线</strong>：CPU和I/O设备之间。</li>
<li><strong>DMA（直接存储器访问）总线</strong>：内存和高速I/O设备（如磁盘）之间直接交换数据。高速外设可通过DMA总线直接与主存进行信息交换。</li>
<li><em>特点</em>：任一时刻只能使用一种总线。</li>
<li>以CPU为中心：低速外设需通过CPU才能与主存进行信息交换。</li>
</ul>
</li>
</ol>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/post_article/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/3-8.png" alt="图 3.8 三总线结构"></p>
<ol start="4">
<li><strong>三总线结构的又一形式（带Cache）</strong>：
<ul>
<li><strong>局部总线</strong>：连接CPU和Cache（高速缓存）。</li>
<li><strong>系统总线</strong>：连接Cache和主存。</li>
<li><strong>扩展总线</strong>：连接各种外部设备（如Modem、串口、局域网）。</li>
</ul>
</li>
<li><strong>四总线结构</strong>：
<ul>
<li>在上面的基础上，增加了一条<strong>高速总线</strong>，专门挂接高速设备（如高速局域网、图形工作站、多媒体）。</li>
<li>低速设备（如传真、打印机）依然挂在扩展总线上。</li>
</ul>
</li>
</ol>
<h4 id="3-4-3-总线结构举例">3.4.3 总线结构举例</h4>
<ul>
<li><strong>传统微型机</strong>：ISA总线。</li>
<li><strong>VL-BUS结构</strong>：引入了局部总线，显卡直接连CPU端。</li>
<li><strong>PCI总线结构</strong>：
<ul>
<li>CPU通过<strong>PCI桥</strong>（桥接芯片）连接PCI总线。</li>
<li>PCI总线上挂接高速设备。</li>
<li>PCI总线还可以通过桥接器再连接ISA/EISA总线（挂低速设备）。</li>
<li><em>优点</em>：CPU和PCI设备并行工作，且支持多层结构（桥连桥）。</li>
</ul>
</li>
</ul>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/post_article/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/3-14.png" alt="图 3.14 多层PCI总线结构"></p>
<blockquote>
<ul>
<li><strong>描述</strong>：通过第一级桥、第二级桥层层扩展，每一层都可以挂设备，扩展能力很强。</li>
</ul>
</blockquote>
<h3 id="3-5-总线控制">3.5 总线控制</h3>
<p>总线是共享资源，大家都要用，谁先用？怎么用？这就需要总线控制。主要包括<strong>判优控制</strong>（决定谁用）和<strong>通信控制</strong>（决定怎么传）。</p>
<h4 id="3-5-1-总线判优控制">3.5.1 总线判优控制</h4>
<p>解决多个设备同时争用总线的问题。分为<strong>主设备</strong>（有权发起控制）和<strong>从设备</strong>（只能被动响应）。</p>
<p><strong>1. 集中式控制</strong>（控制逻辑集中在CPU或总线控制器中）：</p>
<ul>
<li><strong>(1) 链式查询</strong>：
<ul>
<li><strong>原理</strong>：控制信号（总线允许BG）像一条链子一样，从第一个设备传到第二个，再传到第三个……</li>
<li><strong>优先级</strong>：离控制器越近，优先级越高。</li>
<li><em>优点</em>：结构极简单，线少。</li>
<li><em>缺点</em>：对电路故障敏感（如果第1个设备坏了，后面的都收不到信号，全瘫痪）；优先级固定，不灵活。</li>
</ul>
</li>
<li><strong>(2) 计数器定时查询</strong>：
<ul>
<li><strong>原理</strong>：总线控制器里有个计数器，按数字（设备地址）喊号。喊到谁，谁就用。</li>
<li><em>优点</em>：优先级可以改变（通过改变计数器的初始值或计数顺序）。</li>
<li><em>缺点</em>：线比链式多一点。</li>
</ul>
</li>
<li><strong>(3) 独立请求方式</strong>：
<ul>
<li><strong>原理</strong>：每个设备都单独拉两根线（请求线BR、允许线BG）直接连到控制器。</li>
<li><em>优点</em>：响应速度最快，优先级控制最灵活。</li>
<li><em>缺点</em>：线太多了，控制逻辑复杂。</li>
</ul>
</li>
</ul>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/post_article/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/3-15.png" alt="图 3.15 集中控制的三种优先权仲裁方式"></p>
<p><strong>2. 分布式控制</strong>：</p>
<ul>
<li>不需要中央控制器，每个设备都有逻辑电路，通过比对优先级号自行决定谁用总线。</li>
</ul>
<h4 id="3-5-2-总线通信控制">3.5.2 总线通信控制</h4>
<p>解决通信双方如何协调时间、配合动作的问题。总线传输周期通常分为：<strong>申请分配</strong> -&gt; <strong>寻址</strong> -&gt; <strong>传数</strong> -&gt; <strong>结束</strong>。</p>
<p><strong>四种通信方式：</strong></p>
<p><strong>1. 同步通信</strong></p>
<ul>
<li><strong>原理</strong>：统一的时间标准。在固定的时间点做固定的事。</li>
<li><em>优点</em>：速度快，控制简单。</li>
<li><em>缺点</em>：必须迁就速度最慢的设备（强制同步），灵活性差。</li>
</ul>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/post_article/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/3-16.png" alt="图 3.16 同步式数据输入传输"></p>
<blockquote>
<ul>
<li><strong>描述</strong>：有一个统一的时钟脉冲信号。T1时刻发地址，T2时刻发命令…所有动作严格对齐时钟边缘。</li>
</ul>
</blockquote>
<p><strong>2. 异步通信</strong></p>
<ul>
<li><strong>原理</strong>：没有公共时钟，采用<strong>应答方式</strong>（握手）。
<ul>
<li>主设备：我发出请求了！</li>
<li>从设备：我收到了！</li>
<li>主设备：那我撤销请求了。</li>
</ul>
</li>
<li><strong>三种握手类型</strong>：
<ul>
<li><strong>(1) 不互锁</strong>：主发请求，不等回答直接撤销；从发回答，不等主撤销直接撤销。（最不可靠）</li>
<li><strong>(2) 半互锁</strong>：主发请求，必须等回答才撤销；从发回答后自动撤销。（主锁从不锁）</li>
<li><strong>(3) 全互锁</strong>：主发请求，等回答才撤销；从发回答，等主撤销请求后，它才撤销回答。（最可靠，最严谨）。</li>
</ul>
</li>
<li><em>优点</em>：灵活，允许速度差异很大的设备通信。</li>
</ul>
<p><strong>3. 半同步通信</strong></p>
<ul>
<li><strong>原理</strong>：保留同步时钟，但增加一条“<strong>等待 (WAIT)</strong>”信号线。</li>
<li><em>应用</em>：当从设备速度跟不上时，拉低WAIT信号，主设备检测到后就“等”它几个周期，直到WAIT信号取消。</li>
<li><em>特点</em>：结合了同步的效率和异步的灵活性。</li>
</ul>
<p><strong>4. 分离式通信</strong></p>
<ul>
<li><strong>原理</strong>：将一个传输周期分成两个子周期。
<ol>
<li><strong>子周期1</strong>：主设备发命令和地址，然后<strong>立即放弃</strong>总线。</li>
<li><strong>空闲期</strong>：从设备在内部准备数据，总线可以让给别人用。</li>
<li><strong>子周期2</strong>：从设备准备好数据后，申请总线，把数据传回给主设备。</li>
</ol>
</li>
<li><em>优点</em>：总线利用率极高，挖掘了总线潜力。</li>
<li><em>特点</em>：只有单方向的信息流，每个模块都变成了主模块。</li>
</ul>
<h2 id="第4章-存储器">第4章 存储器</h2>
<p>本章主要介绍存储器的分类、工作原理、主存的组成、Cache以及辅助存储器。核心在于理解存储系统的<strong>层次结构</strong>（Cache-主存-辅存）。</p>
<h3 id="4-1-概述">4.1 概述</h3>
<h4 id="4-1-1-存储器分类">4.1.1 存储器分类</h4>
<p>存储器是计算机的记忆设备。由于CPU速度极快而存储器速度相对较慢，存储器往往成为系统瓶颈。</p>
<p><strong>1. 按存储介质分类</strong></p>
<ul>
<li><strong>半导体存储器</strong>：
<ul>
<li><strong>材料</strong>：TTL（双极型，速度快但功耗大）、MOS（集成度高，功耗小，主流）。</li>
<li><strong>特点</strong>：体积小、速度快。</li>
<li><strong>缺点</strong>：<strong>易失性</strong>，断电后信息丢失（除了现在的Flash等非易失技术）。</li>
</ul>
</li>
<li><strong>磁表面存储器</strong>：
<ul>
<li><strong>载体</strong>：磁盘、磁带。</li>
<li><strong>原理</strong>：在金属或塑料基体上涂磁性材料，靠磁头读写。</li>
<li><strong>特点</strong>：<strong>非易失性</strong>，断电信息不丢。</li>
</ul>
</li>
<li><strong>光盘存储器</strong>：利用激光读写，非易失。</li>
</ul>
<p><strong>2. 按存取方式分类</strong></p>
<ul>
<li><strong>随机存储器 (RAM)</strong>：
<ul>
<li><strong>定义</strong>：任何一个单元的内容都可以随机存取，存取时间与物理位置<strong>无关</strong>。</li>
<li><strong>应用</strong>：主存。</li>
</ul>
</li>
<li><strong>只读存储器 (ROM)</strong>：
<ul>
<li><strong>定义</strong>：只能读出，不能写入（或只能用特殊方法写入）。</li>
<li><strong>应用</strong>：存放固定不变的程序（如BIOS）。</li>
</ul>
</li>
<li><strong>串行访问存储器</strong>：
<ul>
<li><strong>定义</strong>：读写时需要按物理位置先后顺序寻找。</li>
<li><strong>顺序存取存储器</strong>：如磁带，必须从头走到尾。</li>
<li><strong>直接存取存储器</strong>：如磁盘，先直接跳到某个区域（磁道），再在区域内顺序寻找。</li>
</ul>
</li>
</ul>
<p><strong>3. 按在计算机中的作用分类</strong></p>
<ul>
<li><strong>主存储器（主存）</strong>：可以和CPU<strong>直接</strong>交换信息。速度快，容量小。</li>
<li><strong>辅助存储器（辅存/外存）</strong>：主存的后援，存放暂时不用的数据。<strong>不能</strong>直接和CPU交换信息，必须调入主存。速度慢，容量大。</li>
<li><strong>缓冲存储器（缓存/Cache）</strong>：用在两个速度不同的部件之间（如CPU和主存），起缓冲作用。</li>
</ul>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/post_article/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/4-1.png" alt="图 4.1 存储器分类"></p>
<blockquote>
<ul>
<li><strong>描述</strong>：展示了存储器的分类树状图。主存包括RAM（静态、动态）和ROM（MROM, PROM, EPROM, EEPROM）。辅存包括磁盘、磁带、光盘。</li>
</ul>
</blockquote>
<h4 id="4-1-2-存储器的层次结构">4.1.2 存储器的层次结构</h4>
<p>存储器有三个核心指标：<strong>速度、容量、位价</strong>（每位价格）。</p>
<ul>
<li><strong>矛盾</strong>：速度越快，价格越高，容量往往越小。</li>
<li><strong>解决</strong>：采用多级层次结构。</li>
</ul>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/post_article/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/4-2.png" alt="图 4.2 存储器速度、容量和位价的关系"></p>
<blockquote>
<ul>
<li><strong>描述</strong>：一个金字塔结构。塔尖是寄存器（最快、最贵、最小），塔底是磁带（最慢、最便宜、最大）。</li>
</ul>
</blockquote>
<p><strong>存储系统的缓存、主存、辅存层次：</strong></p>
<ol>
<li><strong>缓存-主存层次</strong>：
<ul>
<li><strong>目的</strong>：解决<strong>CPU和主存速度不匹配</strong>的问题。</li>
<li><strong>原理</strong>：利用Cache（高速小容量）存放CPU近期要用的数据。</li>
<li><strong>透明性</strong>：对程序员透明（自动完成），数据调动由<strong>硬件</strong>完成。</li>
</ul>
</li>
<li><strong>主存-辅存层次</strong>：
<ul>
<li><strong>目的</strong>：解决<strong>存储容量</strong>的问题。</li>
<li><strong>原理</strong>：利用辅存（低速大容量）存放大量数据，用时调入主存。</li>
<li><strong>透明性</strong>：数据调动由<strong>硬件和操作系统</strong>共同完成。由此形成了<strong>虚拟存储器</strong>的概念（让程序员觉得内存无穷大）。</li>
</ul>
</li>
</ol>
<h3 id="4-2-主存储器">4.2 主存储器</h3>
<h4 id="4-2-1-概述">4.2.1 概述</h4>
<p>主存由存储体、驱动器、译码器、读写电路等组成。</p>
<ul>
<li><strong>MAR和MDR逻辑上属于主存，物理上制作在CPU芯片内。</strong></li>
</ul>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/post_article/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/4-4.png" alt="图 4.4 主存的基本组成"></p>
<blockquote>
<ul>
<li><strong>描述</strong>：MAR（地址寄存器）接收地址 -&gt; 译码器/驱动器找到单元 -&gt; 存储体 -&gt; 读写电路 -&gt; MDR（数据寄存器）输出数据。</li>
</ul>
</blockquote>
<ul>
<li><strong>主存与CPU的联系</strong>：
<ul>
<li>CPU通过<strong>地址总线</strong>发地址给MAR。</li>
<li>CPU通过<strong>数据总线</strong>与MDR交换数据。</li>
<li>CPU通过<strong>控制总线</strong>发读/写命令。</li>
</ul>
</li>
</ul>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/post_article/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/4-5.png" alt="图 4.5 主存和CPU的联系"></p>
<blockquote>
<ul>
<li><strong>描述</strong>：CPU和主存之间通过三组线（MDR连数据线，MAR连地址线，CPU发读写信号）连接。</li>
</ul>
</blockquote>
<ul>
<li>
<p><strong>主存中存储单元地址的分配</strong>：</p>
<ul>
<li><strong>大端模式 (Big-Endian)</strong>：高位字节排在低地址（符合人类阅读习惯）。</li>
<li><strong>小端模式 (Little-Endian)</strong>：低位字节排在低地址。</li>
<li><em>注意</em>：寻址范围取决于地址线位数。例如24位地址线，按字节寻址范围是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>24</mn></msup><mo>=</mo><mn>16</mn><mtext>M</mtext></mrow><annotation encoding="application/x-tex">2^{24}=16\text{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">6</span><span class="mord text"><span class="mord">M</span></span></span></span></span>。</li>
</ul>
</li>
<li>
<p><strong>主存的技术指标</strong>：</p>
<ol>
<li><strong>存储容量</strong>：存储单元个数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>×</mo></mrow><annotation encoding="application/x-tex">\times</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">×</span></span></span></span> 存储字长。</li>
<li><strong>存储速度</strong>：
<ul>
<li><strong>存取时间</strong>：启动一次操作到完成的时间。</li>
<li><strong>存取周期</strong>：连续两次独立操作所需的<strong>最小间隔时间</strong>。（周期 &gt; 时间，因为读写后电路需要一段恢复时间）。</li>
</ul>
</li>
<li><strong>存储器带宽</strong>：单位时间内存储器存取的信息量（位/秒或字节/秒）。</li>
</ol>
</li>
</ul>
<h4 id="4-2-2-半导体存储芯片简介">4.2.2 半导体存储芯片简介</h4>
<p><strong>1. 基本结构</strong><br>
<img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/post_article/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/4-7.png" alt="图 4.7 存储芯片的基本结构"></p>
<ul>
<li><strong>译码驱动</strong>：把地址变成选择信号，选中某个存储单元。</li>
<li><strong>存储矩阵</strong>：存放0/1的阵列。</li>
<li><strong>读写电路</strong>：完成读写操作。</li>
<li><strong>引脚</strong>：地址线（单向）、数据线（双向）、控制线（片选CS、读写WE）。
<ul>
<li>
<p><strong>地址线</strong>：单向输入，其位数与芯片容量有关。</p>
</li>
<li>
<p><strong>数据线</strong>：双向，其位数与芯片可读出或写入的数据位数有关。数据线的位数与芯片容量有关。</p>
</li>
<li>
<p><strong>地址线和数据线的位数共同反映存储芯片的容量</strong>：例如，地址线10根，数据线4根，则芯片容量为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>10</mn></msup><mo>×</mo><mn>4</mn><mo>=</mo><mn>4</mn><mi>K</mi></mrow><annotation encoding="application/x-tex">2^{10} \times 4 = 4K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">4</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> 位。</p>
</li>
<li>
<p><strong>读/写控制线</strong>：决定芯片进行读/写操作。</p>
<ul>
<li>一根线<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mrow><mi>W</mi><mi>E</mi></mrow><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">\overline{WE}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8833300000000001em;vertical-align:0em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833300000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span><span style="top:-3.80333em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span></span></span></span>: 低电平写，高电平读</li>
<li>两根线<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mrow><mi>O</mi><mi>E</mi></mrow><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">\overline{OE}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8833300000000001em;vertical-align:0em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833300000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span><span style="top:-3.80333em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span></span></span></span>: 低电平有效，允许读<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mrow><mi>W</mi><mi>E</mi></mrow><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">\overline{WE}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8833300000000001em;vertical-align:0em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833300000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span><span style="top:-3.80333em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span></span></span></span>: 低电平有效，允许写</li>
</ul>
</li>
<li>
<p><strong>片选线 (CS/CE)</strong>：Chip Select，用来选择存储芯片。低电平有效时，芯片才工作。这是<strong>扩展存储器</strong>的关键。</p>
<ul>
<li>芯片选择线：选择存储芯片</li>
<li>标识方式<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mrow><mi>C</mi><mi>S</mi></mrow><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">\overline{CS}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8833300000000001em;vertical-align:0em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833300000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span><span style="top:-3.80333em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span></span></span></span>: 芯片选择，低电平有效<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mrow><mi>C</mi><mi>E</mi></mrow><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">\overline{CE}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8833300000000001em;vertical-align:0em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833300000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span><span style="top:-3.80333em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span></span></span></span>: 芯片使能，低电平有效</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>2. 译码驱动方式</strong></p>
<ul>
<li><strong>线选法</strong>：
<ul>
<li>一根字线选中一个字的所有位。</li>
<li><em>缺点</em>：地址线多时，字线太多，芯片很难设计。适合小容量。</li>
</ul>
</li>
</ul>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/post_article/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/4-9.png" alt="图 4.9 16×1字节线选法结构示意图"></p>
<ul>
<li><strong>重合法</strong>：
<ul>
<li>将地址分为<strong>行地址</strong>和<strong>列地址</strong>。</li>
<li>行、列交叉点才是选中的单元。</li>
<li><em>优点</em>：大大减少了选择线的数量。适合大容量。</li>
</ul>
</li>
</ul>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/post_article/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/4-10.png" alt="图 4.10 1K×1位重合法结构示意图"></p>
<ul>
<li><strong>重合法 VS 线选法</strong>：
<ul>
<li>假设存储器容量为1M × 8位，需要怎样的地址译码器？</li>
<li>线选法
<ul>
<li>输入：20条地址线，输出：1M条线</li>
<li>需要的输出线数过大，集成度低，只适用于小容量的存储芯片</li>
</ul>
</li>
<li>重合法
<ul>
<li>用8个1M × 1位存储芯片构成</li>
<li>行地址：输入：10条行地址线，输出：1K条线</li>
<li>列地址：输入：10条列地址线，输出：1K条线</li>
<li>集成度高，适用于大容量芯片</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="4-2-3-随机存取存储器-RAM">4.2.3 随机存取存储器 (RAM)</h4>
<p>随机存取存储器（RAM）根据存储信息的原理不同，分为静态RAM（SRAM）和动态RAM（DRAM）。</p>
<p><strong>1. 静态 RAM (Static RAM, SRAM)</strong></p>
<ul>
<li><strong>存储原理</strong>：利用<strong>触发器</strong>（双稳态电路）来存储“0”和“1”。</li>
<li><strong>基本单元</strong>：通常由6个MOS管组成。
<ul>
<li><em>理解</em>：触发器就像一个开关，拨上去是1，拨下来是0，只要不断电，它就一直保持在这个状态，非常稳定。</li>
</ul>
</li>
<li><strong>特点</strong>：
<ul>
<li><strong>速度快</strong>：不需要刷新，读写速度非常快。</li>
<li><strong>集成度低</strong>：一个存储位需要6个晶体管，占用硅片面积大。</li>
<li><strong>功耗大</strong>：电路一直处于导通状态。</li>
<li><strong>价格贵</strong>。</li>
<li><strong>易失性</strong>：断电后信息丢失。</li>
</ul>
</li>
<li><strong>应用</strong>：通常用作<strong>高速缓冲存储器 (Cache)</strong>。</li>
<li><strong>读/写时序</strong>：
<ul>
<li><strong>读周期</strong>：地址有效 -&gt; 片选有效 -&gt; 数据输出。</li>
<li><strong>写周期</strong>：地址有效 -&gt; 片选有效 -&gt; 写命令有效 -&gt; 数据输入。</li>
</ul>
</li>
</ul>
<p><strong>2. 动态 RAM (Dynamic RAM, DRAM)</strong></p>
<ul>
<li><strong>存储原理</strong>：利用<strong>电容</strong>存储电荷的原理来寄存信息。
<ul>
<li>电容上有电荷代表“1”，无电荷代表“0”。</li>
</ul>
</li>
<li><strong>基本单元</strong>：常见的有三管式和单管式（1个MOS管+1个电容）。
<ul>
<li><em>理解</em>：就像一个小水桶，有水是1，没水是0。</li>
</ul>
</li>
<li><strong>特点</strong>：
<ul>
<li><strong>集成度高</strong>：结构简单，体积小。</li>
<li><strong>功耗低</strong>。</li>
<li><strong>价格便宜</strong>。</li>
<li><strong>速度较慢</strong>。</li>
<li><strong>需要刷新</strong>：这是DRAM最大的特点。
<ul>
<li><em>理解</em>：因为电容（水桶）会漏电（漏水），时间长了“1”就变成了“0”，所以必须每隔一段时间给它充电（加水），这叫“刷新”。</li>
</ul>
</li>
</ul>
</li>
<li><strong>应用</strong>：通常用作<strong>主存储器（内存）</strong>。</li>
</ul>
<p><strong>3. DRAM的刷新</strong><br>
刷新本质上是<strong>先读出，再写入</strong>（再生）的过程。刷新是按<strong>行</strong>进行的。<br>
常见的刷新方式有三种：</p>
<ul>
<li><strong>(1) 集中刷新</strong>：
<ul>
<li><strong>原理</strong>：在规定的刷新周期（如2ms）内，拿出一言段时间，把所有行全部刷新一遍。</li>
<li><strong>死区</strong>：在刷新期间，CPU无法访问存储器，这段时间称为“死时间”或“访存死区”。</li>
<li><em>理解</em>：像商店每天专门停业一小时来盘点货物，这期间顾客不能买东西。</li>
</ul>
</li>
<li><strong>(2) 分散刷新</strong>：
<ul>
<li><strong>原理</strong>：把存取周期加长（如翻倍）。前半段用来正常读写，后半段用来刷新某一行。</li>
<li><strong>特点</strong>：没有死区，但存取周期变长了，整个系统速度变慢。</li>
<li><em>理解</em>：像商店每卖一件货，就强制盘点一下库存，效率低。</li>
</ul>
</li>
<li><strong>(3) 异步刷新</strong>（最常用）：
<ul>
<li><strong>原理</strong>：结合了前两者。将刷新任务平均分配到整个刷新周期（2ms）内。假设有128行，2ms内要刷完，那么每隔 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>m</mi><mi>s</mi><mo>÷</mo><mn>128</mn><mo>≈</mo><mn>15.6</mn><mi>μ</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">2ms \div 128 \approx 15.6\mu s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">÷</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">2</span><span class="mord">8</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mord">5</span><span class="mord">.</span><span class="mord">6</span><span class="mord mathnormal">μ</span><span class="mord mathnormal">s</span></span></span></span> 刷新一行。</li>
<li><strong>特点</strong>：既没有长时间的死区，又不拖慢每个存取周期。</li>
<li><em>理解</em>：利用CPU不访问内存的间隙（比如译码阶段）偷偷刷新一行，既不耽误事，也能完成任务。</li>
</ul>
</li>
</ul>
<h4 id="4-2-4-只读存储器-ROM">4.2.4 只读存储器 (ROM)</h4>
<p>ROM的发展经历了几个阶段：</p>
<ol>
<li><strong>掩模 ROM (MROM)</strong>：厂家出厂时写死，用户无法修改。</li>
<li><strong>PROM (Programmable ROM)</strong>：一次性编程。用户可以用专门设备写一次，写坏了就废了（熔丝原理）。</li>
<li><strong>EPROM (Erasable PROM)</strong>：可擦除。用<strong>紫外线</strong>照射擦除，可以重写多次。</li>
<li><strong>EEPROM (E-squared PROM)</strong>：<strong>电</strong>可擦除。不需要紫外线，直接电信号擦除重写。</li>
<li><strong>Flash Memory (闪存)</strong>：基于EEPROM技术，具备RAM功能。<strong>整块</strong>擦除，速度快，集成度高。如U盘、SSD。</li>
</ol>
<h4 id="4-2-5-存储器与-CPU-的连接">4.2.5 存储器与 CPU 的连接</h4>
<p>单块芯片容量不够，需要将多块芯片连起来组成大内存。</p>
<p><strong>1. 容量扩展（三种方式）</strong></p>
<ul>
<li><strong>位扩展</strong>（增加字长）：
<ul>
<li><em>场景</em>：芯片只有1位或4位，但CPU需要8位或16位数据。</li>
<li><em>连法</em>：<strong>地址线并联</strong>（都接一样的），<strong>数据线分别</strong>接到CPU数据总线的不同位，<strong>片选线并联</strong>（同时工作）。</li>
</ul>
</li>
</ul>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/post_article/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/4-33.png" alt="图 4.33 由8片16K×1位的芯片组成16K×8位的存储器"></p>
<ul>
<li><strong>字扩展</strong>（增加字数/容量）：
<ul>
<li><em>场景</em>：芯片只有1K容量，但需要16K容量。</li>
<li><em>连法</em>：<strong>地址线低位并联</strong>，<strong>数据线并联</strong>。<strong>地址线高位</strong>通过译码器分别接各芯片的<strong>片选线</strong>（CS）。</li>
</ul>
</li>
</ul>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/post_article/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/4-34.png" alt="图 4.34 由2片1K×8位的芯片组成2K×8位的存储器"></p>
<ul>
<li><strong>字、位同时扩展</strong>：既增加位数，又增加容量。先位扩展组成一组，再字扩展连接多组。</li>
</ul>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/post_article/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/4-35.png" alt="图 4.35 由8片1K×4位的芯片组成4K×8位的存储器"></p>
<p><strong>2. 连接步骤</strong></p>
<ol>
<li><strong>地址线</strong>：CPU低位对芯片低位，高位用于片选译码。</li>
<li><strong>数据线</strong>：位数匹配。</li>
<li><strong>读/写命令线</strong>：直接连接。</li>
<li><strong>片选线</strong>：这是核心。利用高位地址经过<strong>译码器</strong>（如74138）产生片选信号，保证任何时候只选中一组芯片。</li>
</ol>
<p>这里使用<strong>原书例 4.2</strong> 来详细说明如何进行存储器扩展和连接。</p>
<p><strong>题目要求：</strong></p>
<ul>
<li><strong>CPU信号</strong>：16根地址线 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mn>15</mn></msub><mo>…</mo><msub><mi>A</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">A_{15} \dots A_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>)，8根数据线 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mn>7</mn></msub><mo>…</mo><msub><mi>D</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">D_7 \dots D_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">7</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>)，MREQ（访存控制，低电平有效），WR（高读低写）。</li>
<li><strong>地址空间分配要求</strong>：
<ol>
<li><strong>系统程序区</strong>：最小8K地址范围 -&gt; 选用 <strong>ROM</strong>。</li>
<li><strong>用户程序区</strong>：与其相邻的16K地址范围 -&gt; 选用 <strong>RAM</strong>。</li>
<li><strong>系统程序工作区</strong>：最大4K地址范围 -&gt; 选用 <strong>RAM</strong>。</li>
</ol>
</li>
<li><strong>可用芯片</strong>：8K×8位 ROM，8K×8位 RAM，4K×8位 RAM，74138译码器等。</li>
</ul>
<p><strong>解题步骤详解：</strong></p>
<p><strong>(1) 写出二进制地址码（确定地址范围）</strong><br>
地址线16根，总寻址范围64K。</p>
<ul>
<li><strong>最小8K (0 ~ 8K-1)</strong>：
<ul>
<li>二进制：0000 0000 0000 0000 ~ 0001 1111 1111 1111</li>
<li>十六进制：<code>0000H</code> ~ <code>1FFFH</code></li>
<li>高3位 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mn>15</mn></msub><msub><mi>A</mi><mn>14</mn></msub><msub><mi>A</mi><mn>13</mn></msub></mrow><annotation encoding="application/x-tex">A_{15}A_{14}A_{13}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>) 为 <code>000</code>。</li>
</ul>
</li>
<li><strong>相邻16K (8K ~ 24K-1)</strong>：
<ul>
<li>因为现有芯片最大是8K，所以16K需要两片8K芯片。</li>
<li><strong>第一片8K (8K ~ 16K-1)</strong>：
<ul>
<li>二进制：0010 0000 0000 0000 ~ 0011 1111 1111 1111</li>
<li>十六进制：<code>2000H</code> ~ <code>3FFFH</code></li>
<li>高3位 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mn>15</mn></msub><msub><mi>A</mi><mn>14</mn></msub><msub><mi>A</mi><mn>13</mn></msub></mrow><annotation encoding="application/x-tex">A_{15}A_{14}A_{13}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>) 为 <code>001</code>。</li>
</ul>
</li>
<li><strong>第二片8K (16K ~ 24K-1)</strong>：
<ul>
<li>二进制：0100 0000 0000 0000 ~ 0101 1111 1111 1111</li>
<li>十六进制：<code>4000H</code> ~ <code>5FFFH</code></li>
<li>高3位 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mn>15</mn></msub><msub><mi>A</mi><mn>14</mn></msub><msub><mi>A</mi><mn>13</mn></msub></mrow><annotation encoding="application/x-tex">A_{15}A_{14}A_{13}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>) 为 <code>010</code>。</li>
</ul>
</li>
</ul>
</li>
<li><strong>最大4K (60K ~ 64K-1)</strong>：
<ul>
<li>二进制：1111 0000 0000 0000 ~ 1111 1111 1111 1111</li>
<li>十六进制：<code>F000H</code> ~ <code>FFFFH</code></li>
<li>高3位 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mn>15</mn></msub><msub><mi>A</mi><mn>14</mn></msub><msub><mi>A</mi><mn>13</mn></msub></mrow><annotation encoding="application/x-tex">A_{15}A_{14}A_{13}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>) 为 <code>111</code>。</li>
</ul>
</li>
</ul>
<p><strong>(2) 确定芯片数量</strong></p>
<ul>
<li>系统程序区 (8K)：选 <strong>1片</strong> 8K×8位 ROM。</li>
<li>用户程序区 (16K)：选 <strong>2片</strong> 8K×8位 RAM。</li>
<li>系统工作区 (4K)：选 <strong>1片</strong> 4K×8位 RAM。</li>
</ul>
<p><strong>(3) 构造片选逻辑 (画图核心)</strong><br>
利用74138译码器（3-8译码器）来控制片选信号。</p>
<ul>
<li><strong>输入</strong>：将CPU的高3位地址 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mn>15</mn></msub><mo separator="true">,</mo><msub><mi>A</mi><mn>14</mn></msub><mo separator="true">,</mo><msub><mi>A</mi><mn>13</mn></msub></mrow><annotation encoding="application/x-tex">A_{15}, A_{14}, A_{13}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 接到74138的输入端 C, B, A。</li>
<li><strong>控制端</strong>：74138的使能端 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>G</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">G_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 接+5V，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>G</mi><mo>ˉ</mo></mover><mrow><mn>2</mn><mi>A</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\bar{G}_{2A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9701099999999999em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">G</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>G</mi><mo>ˉ</mo></mover><mrow><mn>2</mn><mi>B</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\bar{G}_{2B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9701099999999999em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">G</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 接 MREQ（访存信号），保证只有访存时译码器才工作。</li>
<li><strong>输出（低电平有效）</strong>：
<ul>
<li><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">Y_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> (<code>000</code>)</strong>：选中 ROM (系统程序区)。</li>
<li><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">Y_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> (<code>001</code>)</strong>：选中 RAM 1 (用户程序区前半段)。</li>
<li><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">Y_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> (<code>010</code>)</strong>：选中 RAM 2 (用户程序区后半段)。</li>
<li><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mn>7</mn></msub></mrow><annotation encoding="application/x-tex">Y_7</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">7</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> (<code>111</code>)</strong>：选中 RAM 3 (系统工作区)。
<ul>
<li><em>注意</em>：RAM 3是4K芯片，只需要12根地址线 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mn>11</mn></msub><mo>…</mo><msub><mi>A</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">A_{11} \dots A_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>)。但系统给了它最大4K的空间，所以这里 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mn>12</mn></msub></mrow><annotation encoding="application/x-tex">A_{12}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 必须为高电平。在连线时，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mn>7</mn></msub></mrow><annotation encoding="application/x-tex">Y_7</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">7</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 输出后通常还要跟 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mn>12</mn></msub></mrow><annotation encoding="application/x-tex">A_{12}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 的逻辑配合（或者简单地将 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mn>12</mn></msub></mrow><annotation encoding="application/x-tex">A_{12}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 连到芯片地址线，虽然芯片只用12根，高位可忽略，视具体题目逻辑要求，本例中直接用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mn>7</mn></msub></mrow><annotation encoding="application/x-tex">Y_7</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">7</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 选通即可）。</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/post_article/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/4-38.png" alt="图 4.38 例4.2 CPU与存储芯片的连接图"></p>
<blockquote>
<ul>
<li><strong>标记</strong>：图中展示了74138译码器的连接，以及各芯片地址线、数据线、读写线的连接方式。</li>
</ul>
</blockquote>
<h4 id="4-2-6-存储器的校验-汉明码">4.2.6 存储器的校验 (汉明码)</h4>
<p>在计算机运行中，数据可能出错（如0变1）。汉明码是一种能够<strong>纠正1位错误</strong>，<strong>检测2位错误</strong>的编码。</p>
<p><strong>1. 汉明码的组成公式</strong><br>
设 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span> 为数据位的位数，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> 为检测位（校验位）的位数。必须满足以下关系：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mn>2</mn><mi>k</mi></msup><mo>≥</mo><mi>n</mi><mo>+</mo><mi>k</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2^k \ge n + k + 1 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.035078em;vertical-align:-0.13597em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></span></p>
<ul>
<li><em>理解</em>：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> 位校验位能表示 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>k</mi></msup></mrow><annotation encoding="application/x-tex">2^k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.849108em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span> 种状态。其中1种状态表示“全对”，剩下 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>k</mi></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2^k-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.932438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 种状态要能覆盖 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>+</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">n+k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> 个位置的每一位出错的情况。</li>
</ul>
<p><strong>2. 检测位的位置</strong><br>
检测位 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">C_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 不是随便放的，必须安插在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">2^{i-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.824664em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span> 的位置上（即第1, 2, 4, 8…位）。</p>
<ul>
<li>例如 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">n=4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">4</span></span></span></span> (数据1100)，需要 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">k=3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span></span></span></span> (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>3</mn></msup><mo>≥</mo><mn>4</mn><mo>+</mo><mn>3</mn><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2^3 \ge 4+3+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.950078em;vertical-align:-0.13597em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>)。</li>
<li>总长度7位。检测位在第1, 2, 4位。数据位在3, 5, 6, 7位。</li>
</ul>
<p><strong>3. 汉明码的编码方法 (分组奇偶校验)</strong></p>
<ul>
<li>每个检测位 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">C_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 负责校验一组数据。</li>
<li><strong>分组规则</strong>：将所有位置号（二进制）中，第 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> 位是1的归为一组，由 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">C_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 负责。
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">C_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> (位置1, <code>001</code>)：负责所有二进制最低位是1的位置（1, 3, 5, 7, 9…）</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">C_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> (位置2, <code>010</code>)：负责所有二进制倒数第2位是1的位置（2, 3, 6, 7, 10…）</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">C_4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> (位置4, <code>100</code>)：负责所有二进制倒数第3位是1的位置（4, 5, 6, 7, 12…）</li>
</ul>
</li>
<li><strong>计算值</strong>：采用<strong>异或</strong>运算（偶校验），使该组内1的个数为偶数。</li>
</ul>
<p><strong>4. 汉明码的纠错过程</strong><br>
收到数据后，重新计算各组的校验值，得到一个新的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> 位代码，称为<strong>故障字</strong>或<strong>伴举症</strong> (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>k</mi></msub><mo>…</mo><msub><mi>P</mi><mn>2</mn></msub><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_k \dots P_2 P_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>)。</p>
<ul>
<li>若 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">P = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>：无错。</li>
<li>若 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo mathvariant="normal">≠</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">P \neq 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span> 的十进制数值就是<strong>出错位的位号</strong>。
<ul>
<li>例如算出 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>4</mn></msub><msub><mi>P</mi><mn>2</mn></msub><msub><mi>P</mi><mn>1</mn></msub><mo>=</mo><mn>110</mn></mrow><annotation encoding="application/x-tex">P_4 P_2 P_1 = 110</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">1</span><span class="mord">0</span></span></span></span> (十进制6)，说明第6位出错了，直接对第6位取反（0变1，1变0）即可纠正。</li>
</ul>
</li>
</ul>
<h4 id="4-2-7-提高访存速度的措施">4.2.7 提高访存速度的措施</h4>
<p><strong>1. 单体多字系统</strong></p>
<ul>
<li>一次存取读出多个字（如4个字）。</li>
<li><em>前提</em>：指令和数据在内存中是连续存放的。</li>
</ul>
<p><strong>2. 多体并行系统</strong></p>
<ul>
<li><strong>高位交叉编址（顺序存储）</strong>：
<ul>
<li>高位地址选模块。</li>
<li><em>效果</em>：仅仅是容量扩大，<strong>不能</strong>提高速度（因为程序通常顺序执行，会一直盯着一个模块访问）。</li>
</ul>
</li>
<li><strong>低位交叉编址（交叉存储）</strong>：
<ul>
<li>低位地址选模块。例如：地址0在模块0，地址1在模块1…</li>
<li><em>效果</em>：<strong>提高速度</strong>。CPU可以轮流启动不同的模块（流水线方式），如果不冲突，存取周期近似缩短为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">1/n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">/</span><span class="mord mathnormal">n</span></span></span></span>。</li>
<li><em>公式</em>：设存取周期为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span>，总线传输周期为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi></mrow><annotation encoding="application/x-tex">\tau</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span></span></span></span>，模块数为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span></span></span></span>。若 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>≥</mo><mi>T</mi><mi mathvariant="normal">/</mi><mi>τ</mi></mrow><annotation encoding="application/x-tex">m \ge T/\tau</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span></span></span></span>，则可以实现流水线存取。</li>
</ul>
</li>
</ul>
<h3 id="4-3-高速缓冲存储器-Cache">4.3 高速缓冲存储器 (Cache)</h3>
<h4 id="4-3-1-概述">4.3.1 概述</h4>
<p>Cache（高速缓冲存储器）主要解决CPU和主存速度不匹配的问题。</p>
<p><strong>1. Cache的工作原理</strong></p>
<ul>
<li>程序访问的局部性原理
<ul>
<li><strong>时间局部性</strong>: 当一个存储单元被访问时，它在未来可能会被多次访问（循环程序、子程序）。</li>
<li><strong>空间局部性</strong>: 当一个存储单元被访问时，其附近的存储单元也可能将被访问（指令、数据通常在主存中顺序存放）。</li>
</ul>
</li>
<li>将CPU近期要用的指令和数据提前从主存送到Cache，使得CPU可以不用访问主存来获取所需的指令和数据
<ul>
<li><strong>时间局部性</strong>: 将当前访问的存储字放入Cache</li>
<li><strong>空间局部性</strong>: 将当前访问的存储字的相邻存储字放入Cache</li>
<li><strong>主存和Cache间以字块为单位进行信息传递</strong></li>
</ul>
</li>
<li>主存的编址
<ul>
<li>由 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">2^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.664392em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span> 个存储字组成，每个字有n位地址。</li>
<li>将主存分成若干块，每块包含相同数量的存储字。</li>
<li>主存地址分为两段：高<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span></span></span></span>位表示主存的块地址，低<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span></span></span></span>位表示块内地址</li>
<li>主存块数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>=</mo><msup><mn>2</mn><mi>m</mi></msup></mrow><annotation encoding="application/x-tex">M = 2^m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.664392em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span></span></span></span>，块长（块内字数） <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>=</mo><msup><mn>2</mn><mi>b</mi></msup></mrow><annotation encoding="application/x-tex">B = 2^b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.849108em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span></span></span></span></span></span></span></span></li>
</ul>
</li>
<li>缓存的编址
<ul>
<li>将缓存分成若干块，每块包含相同数量的存储字，且与主存块长相等</li>
<li>缓存地址分为两段：高<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">c</span></span></span></span>位表示缓存的块地址，低<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span></span></span></span>位表示块内地址。</li>
<li>缓存块数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>=</mo><msup><mn>2</mn><mi>c</mi></msup></mrow><annotation encoding="application/x-tex">C = 2^c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.664392em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span></span></span></span></span></span></span>，块长（块内字数） <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>=</mo><msup><mn>2</mn><mi>b</mi></msup></mrow><annotation encoding="application/x-tex">B = 2^b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.849108em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span></span></span></span></span></span></span></span></li>
</ul>
</li>
<li>主存和缓存的编址
<ul>
<li>主存和缓存块的大小相同</li>
<li>主存和缓存间按整个字块为单位进行信息传递，字块内对应存储字的块内地址完全相同</li>
<li>用<strong>标记</strong>记录与该缓存块建立了对应关系的主存块的主存字块标记</li>
</ul>
</li>
</ul>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/post_article/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/4-49.png" alt="图 4.49 Cache-主存存储空间的基本结构"></p>
<p><strong>2. 命中率公式</strong><br>
命中率 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">h</span></span></span></span>) 是衡量Cache效率的核心指标。</p>
<ul>
<li><strong>定义</strong>：CPU访问的信息在Cache中找到的概率。</li>
<li><strong>公式</strong>：<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>h</mi><mo>=</mo><mfrac><msub><mi>N</mi><mi>c</mi></msub><mrow><msub><mi>N</mi><mi>c</mi></msub><mo>+</mo><msub><mi>N</mi><mi>m</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">h = \frac{N_c}{N_c + N_m} 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.19633em;vertical-align:-0.8360000000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.3139999999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8360000000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>c</mi></msub></mrow><annotation encoding="application/x-tex">N_c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>：访问Cache命中的次数。</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">N_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>：访问主存的次数（即Cache未命中）。</li>
</ul>
</li>
<li><strong>平均访问时间 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>a</mi></msub></mrow><annotation encoding="application/x-tex">t_a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76508em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>)</strong>：<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>t</mi><mi>a</mi></msub><mo>=</mo><mi>h</mi><mo>×</mo><msub><mi>t</mi><mi>c</mi></msub><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>h</mi><mo stretchy="false">)</mo><mo>×</mo><msub><mi>t</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">t_a = h \times t_c + (1 - h) \times t_m 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76508em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.76508em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">h</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.76508em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>c</mi></msub></mrow><annotation encoding="application/x-tex">t_c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76508em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>：命中时的Cache访问时间。</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">t_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76508em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>：未命中时的主存访问时间。</li>
</ul>
</li>
<li><strong>访问效率 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">e</span></span></span></span>)</strong>：<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>e</mi><mo>=</mo><mfrac><msub><mi>t</mi><mi>c</mi></msub><msub><mi>t</mi><mi>a</mi></msub></mfrac><mo>×</mo><mn>100</mn><mi mathvariant="normal">%</mi></mrow><annotation encoding="application/x-tex">e = \frac{t_c}{t_a} \times 100\% 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.1280799999999997em;vertical-align:-0.8360000000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.29208em;"><span style="top:-2.3139999999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8360000000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.80556em;vertical-align:-0.05556em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mord">%</span></span></span></span></span></p>
<ul>
<li><em>理解</em>：效率越高，说明平均访问时间越接近Cache的访问时间。</li>
</ul>
</li>
</ul>
<p><strong>3. Cache的基本结构（4大模块详解）</strong></p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/post_article/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/4-50.png" alt="图 4.50 Cache的基本结构原理框图"></p>
<ul>
<li>
<p><strong>(1) Cache 存储体</strong></p>
<ul>
<li><strong>构成</strong>：由高速的SRAM芯片组成。</li>
<li><strong>单位</strong>：以<strong>块</strong>为单位进行组织。Cache中的块大小与主存中的块大小相同。</li>
<li><strong>作用</strong>：存放从主存调入的指令和数据。</li>
</ul>
</li>
<li>
<p><strong>(2) 地址映射变换机构</strong></p>
<ul>
<li><strong>作用</strong>：将CPU发出的主存地址，转换为Cache地址。</li>
<li><strong>原理</strong>：因为CPU只认识主存地址，不知道数据在Cache里的哪个位置。该机构通过查找<strong>标记 (Tag)</strong>，判断数据是否在Cache中（命中）。</li>
<li><strong>结果</strong>：如果命中，给出Cache地址；如果不命中，启动替换机构。</li>
</ul>
</li>
<li>
<p><strong>(3) 替换机构</strong></p>
<ul>
<li><strong>作用</strong>：当Cache满了，又需要调入新块时，决定踢走哪一块。</li>
<li><strong>策略</strong>：由替换算法决定（如LRU近期最少使用算法、FIFO先进先出算法）。</li>
<li><strong>直接映射的特殊性</strong>：直接映射不需要替换策略，因为位置是固定的，满了只能踢走原来那个。</li>
</ul>
</li>
<li>
<p><strong>(4) Cache的读写控制电路</strong></p>
<ul>
<li><strong>作用</strong>：控制数据的流动和一致性维护。</li>
<li><strong>读操作</strong>：命中则直接读Cache；未命中则读主存并调入Cache。</li>
<li><strong>写操作</strong>：需要解决Cache和主存内容不一致的问题（写直达法、写回法）。
<ul>
<li>写直达法（Write-through）：写操作时数据既写入Cache又写入主存。能随时保证主存和Cache的数据始终一致，但增加了访存次数。</li>
<li>写回法（Write-back）：写操作时只把数据写入Cache而不写入主存，但当Cache数据被替换出去时才写回主存。速度快，但增加了Cache复杂性。</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/post_article/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/4-51.png" alt="图 4.51 Cache的读数操作流程"></p>
<p><strong>4. Cache的改进（简单介绍）</strong><br>
为了进一步提升性能，现代Cache进行了改进：</p>
<ul>
<li><strong>增加级数</strong>：出现<strong>片内Cache (L1)</strong> 和 <strong>片外Cache (L2)</strong>，甚至L3。L1速度最快，L2容量稍大。</li>
<li><strong>分立缓存</strong>：将<strong>指令Cache</strong>和<strong>数据Cache</strong>分开。
<ul>
<li><em>原因</em>：在流水线处理器中，取指令和取数据可能同时进行。分开可以避免资源冲突，提高并行度。</li>
</ul>
</li>
</ul>
<h4 id="4-3-2-Cache-主存地址映射">4.3.2 Cache-主存地址映射</h4>
<p>把主存的块放到Cache的哪里？有三种方式：</p>
<p><strong>1. 直接映射 (Direct Mapping)</strong></p>
<ul>
<li><strong>规则</strong>：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">i = j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>o</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">mod</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span> （ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> 是缓存块号，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> 是主存块号，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span> 是总缓存块数，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>=</mo><msup><mn>2</mn><mi>c</mi></msup></mrow><annotation encoding="application/x-tex">C = 2^c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.664392em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span></span></span></span></span></span></span>）</li>
<li><strong>地址结构</strong>：主存字块标记（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">t</span></span></span></span> 位） + Cache字块地址（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">c</span></span></span></span> 位） + 字块内地址（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span></span></span></span> 位）。</li>
<li><strong>优点</strong>：硬件简单，成本低。</li>
<li><strong>缺点</strong>：不够灵活，容易冲突（即便Cache其他地方空着，只要对应的位置被占了，就得替换）。</li>
</ul>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/post_article/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/4-54.png" alt="图 4.54 直接映射"></p>
<p><strong>2. 全相联映射 (Fully Associative Mapping)</strong></p>
<ul>
<li><strong>规则</strong>：主存的块可以放到Cache的<strong>任何</strong>位置。</li>
<li><strong>地址结构</strong>：主存字块标记（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mi>t</mi><mo>+</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">m=t+c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69841em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">c</span></span></span></span> 位） + 字块内地址（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span></span></span></span> 位）。</li>
<li><strong>优点</strong>：非常灵活，冲突少，命中率高。</li>
<li><strong>缺点</strong>：比较电路极其复杂（因为要跟Cache里所有的标记比较），成本高，速度慢。</li>
</ul>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/post_article/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/4-55.png" alt="图 4.55 全相联映射"></p>
<p><strong>3. 组相联映射 (Set Associative Mapping)</strong></p>
<ul>
<li><strong>规则</strong>：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mi>j</mi><mspace></mspace><mspace width="0.6666666666666666em"/><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mtext> </mtext><mi>Q</mi></mrow><annotation encoding="application/x-tex">i = j \mod Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.6666666666666666em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">Q</span></span></span></span> （ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> 是缓存组号，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> 是主存块号，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">Q</span></span></span></span> 是缓存组数）总缓存块数: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>=</mo><msup><mn>2</mn><mi>c</mi></msup></mrow><annotation encoding="application/x-tex">C = 2^c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.664392em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span></span></span></span></span></span></span>，每组缓存块数: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>=</mo><msup><mn>2</mn><mi>r</mi></msup></mrow><annotation encoding="application/x-tex">R = 2^r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.664392em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span></span></span></span></span></span></span>，缓存组数: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mo>=</mo><msup><mn>2</mn><mrow><mi>c</mi><mo>−</mo><mi>r</mi></mrow></msup></mrow><annotation encoding="application/x-tex">Q = 2^{c-r}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">Q</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.771331em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span></span></span></span></span></span></span></span>。</li>
<li><strong>地址结构</strong>：主存字块标记（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>=</mo><mi>t</mi><mo>+</mo><mi>r</mi></mrow><annotation encoding="application/x-tex">s=t+r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69841em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> 位） + 组地址（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>=</mo><mi>c</mi><mo>−</mo><mi>r</mi></mrow><annotation encoding="application/x-tex">q=c-r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> 位） + 字块内地址（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span></span></span></span> 位）。</li>
<li><strong>理解</strong>：接近全相联的命中率，接近直接映射的简单结构。现代计算机多用此方式。</li>
</ul>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/post_article/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/4-56.png" alt="图 4.56 组相联映射"></p>
<blockquote>
<ul>
<li><strong>描述</strong>：分别展示了三种映射方式的连线逻辑。直接映射是多对一；全相联是多对多；组相联是组间多对一，组内多对多。</li>
</ul>
</blockquote>
<h4 id="4-3-3-替换策略">4.3.3 替换策略</h4>
<p>当Cache满了，新块要进来，旧块必须腾地方。踢谁走？</p>
<ol>
<li><strong>先进先出 (FIFO)</strong>：谁先来的踢谁。简单，但可能踢走常用的数据（比如循环体）。</li>
<li><strong>近期最少使用 (LRU)</strong>：踢走最久没被访问过的。利用了局部性原理，命中率高，但硬件稍复杂。</li>
<li><strong>随机法 (RAND)</strong>：随便踢一个。简单，但命中率无法保证。</li>
</ol>
<h3 id="4-4-辅助存储器">4.4 辅助存储器</h3>
<h4 id="4-4-1-概述">4.4.1 概述</h4>
<p>辅存（外存）特点：不直接与CPU交换信息；容量大、价格低、非易失。</p>
<h4 id="4-4-2-磁记录原理和记录方式">4.4.2 磁记录原理和记录方式</h4>
<ul>
<li><strong>原理</strong>：
<ul>
<li><strong>写</strong>：电流 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span></span></span></span> 磁头 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span></span></span></span> 磁场 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span></span></span></span> 磁层磁化。</li>
<li><strong>读</strong>：磁层运动 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span></span></span></span> 切割磁力线 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span></span></span></span> 感应电流。</li>
</ul>
</li>
<li><strong>编码方式</strong>（将0/1变成电流波形）：
<ul>
<li><strong>NRZ (不归零制)</strong>：磁头电流方向代表0/1。</li>
<li><strong>NRZ1 (见1就翻)</strong>：遇到1电流翻转，遇到0不变。</li>
<li><strong>PM (调相制)</strong>：每一位中间都有跳变。方向不同代表0/1。自带同步信号（自同步）。</li>
<li><strong>FM (调频制)</strong>：每一位开始都跳变，中间跳变表示1，不跳变表示0。</li>
</ul>
</li>
</ul>
<h4 id="4-4-3-硬磁盘存储器">4.4.3 硬磁盘存储器</h4>
<ul>
<li><strong>结构</strong>：
<ul>
<li><strong>盘片</strong>：存储数据。</li>
<li><strong>磁头</strong>：读写数据。悬浮在盘面上（温切斯特技术，密封）。</li>
<li><strong>磁道</strong>：同心圆。</li>
<li><strong>柱面</strong>：所有盘片相同半径的磁道组成一个柱面。</li>
<li><strong>扇区</strong>：磁道被分为若干扇区。</li>
</ul>
</li>
<li><strong>存取时间</strong>（重要）：
<ul>
<li><strong>寻道时间</strong>：磁头移动到指定磁道（最慢，机械运动）。</li>
<li><strong>旋转延迟时间</strong>：等待扇区转到磁头下（平均为转半圈的时间）。</li>
<li><strong>传输时间</strong>：读写数据的时间。</li>
</ul>
</li>
<li><strong>技术指标</strong>：记录密度（道密度/位密度）、存储容量、平均寻址时间、数据传输率。</li>
</ul>
<h4 id="4-4-4-软磁盘存储器">4.4.4 软磁盘存储器</h4>
<p>接触式读写，速度慢，容量小，已淘汰。</p>
<h4 id="4-4-5-磁带存储器">4.4.5 磁带存储器</h4>
<p>串行存取（必须顺序查找），适合大容量备份。</p>
<h4 id="4-4-6-循环冗余校验-CRC">4.4.6 循环冗余校验 (CRC)</h4>
<ul>
<li><strong>用途</strong>：磁盘数据校验。</li>
<li><strong>原理</strong>：利用生成多项式 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">G(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span> 进行模2除法（异或运算）。余数为0则无错。</li>
</ul>
<h4 id="4-4-7-光盘存储器">4.4.7 光盘存储器</h4>
<ul>
<li><strong>CD-ROM</strong>：只读。压模制成。</li>
<li><strong>WORM</strong>：写一次读多次。</li>
<li><strong>可擦写光盘</strong>：利用热磁效应或相变原理，可重复读写。</li>
</ul>
<h2 id="第5章-输入输出系统">第5章 输入输出系统</h2>
<h3 id="5-1-概述">5.1 概述</h3>
<p>输入输出（I/O）系统是计算机硬件系统的第三个关键部分，负责处理主机与外部世界的信息交换。</p>
<h4 id="5-1-1-输入输出系统的发展概况">5.1.1 输入输出系统的发展概况</h4>
<p>I/O系统的发展经历了从简单到复杂、从CPU高度干预到独立处理的过程，大致可分为4个阶段：</p>
<ol>
<li>
<p><strong>早期阶段</strong>：</p>
<ul>
<li><strong>特点</strong>：I/O设备与主存交换信息都必须<strong>通过CPU</strong>。</li>
<li><strong>缺点</strong>：
<ul>
<li>每个设备都有独立的逻辑电路，线路散乱。</li>
<li><strong>串行工作</strong>：I/O与CPU串行，I/O工作时CPU必须停止运算进行控制，极浪费时间。</li>
<li><strong>扩展困难</strong>：设备与CPU控制器紧密耦合，增减设备难。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>接口模块和DMA阶段</strong>：</p>
<ul>
<li><strong>接口模块</strong>：I/O设备通过<strong>接口</strong>挂到总线上。
<ul>
<li>接口内有数据通路和控制通路，起到缓冲、串并转换、传递控制命令等作用。</li>
<li>实现了CPU与I/O设备<strong>并行工作</strong>（设备准备数据时，CPU可执行程序）。</li>
<li><strong>局限</strong>：数据交换时（如中断响应后）仍需CPU暂停现行程序参与。</li>
</ul>
</li>
<li><strong>DMA (直接存储器存取) 阶段</strong>：
<ul>
<li><strong>特点</strong>：I/O设备与主存之间有一条<strong>直接数据通路</strong>。</li>
<li><strong>优点</strong>：数据交换不经过CPU，CPU资源利用率进一步提高。</li>
</ul>
</li>
</ul>
</li>
</ol>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/post_article/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/5-2.png" alt="图 5.2 I/O 设备通过接口与主机交换信息"></p>
<ol start="3">
<li>
<p><strong>具有通道结构的阶段</strong>：</p>
<ul>
<li><strong>背景</strong>：在大中型机中，I/O设备繁多，若都配专用DMA接口会增加成本且控制复杂。</li>
<li><strong>通道</strong>：一种<strong>具有特殊功能的处理器</strong>（从属于CPU）。
<ul>
<li>有专用的<strong>通道指令</strong>（通道控制字 CCW）。</li>
<li>可以独立执行通道程序，管理I/O设备与主存交换信息。</li>
</ul>
</li>
<li><strong>优点</strong>：CPU只需启动通道，后续工作由通道完成，极大提高了CPU效率。</li>
</ul>
</li>
<li>
<p><strong>具有I/O处理机的阶段</strong>：</p>
<ul>
<li><strong>I/O处理机 (PPU)</strong>：基本<strong>独立于主机</strong>工作。</li>
<li><strong>功能</strong>：不仅完成I/O控制，还能进行码制变换、格式处理、检错纠错等。</li>
<li><strong>优点</strong>：I/O系统具有更大的独立性，并行性更高。</li>
</ul>
</li>
</ol>
<h4 id="5-1-2-输入输出系统的组成">5.1.2 输入输出系统的组成</h4>
<p>I/O系统由<strong>I/O软件</strong>和<strong>I/O硬件</strong>两部分组成。</p>
<p><strong>1. I/O软件</strong></p>
<ul>
<li><strong>任务</strong>：程序/数据输入、结果输出、系统协调。</li>
<li><strong>I/O指令</strong>：CPU指令系统的一部分。
<ul>
<li><strong>格式</strong>：[ 操作码 ] [ 命令码 ] [ 设备码 ]
<ul>
<li><strong>操作码</strong>：识别是否为I/O指令。</li>
<li><strong>命令码</strong>：做什么操作（如读、写、状态测试、控制操作）。</li>
<li><strong>设备码</strong>：对哪个设备操作（相当于设备地址）。</li>
</ul>
</li>
</ul>
</li>
<li><strong>通道指令 (CCW)</strong>：
<ul>
<li><strong>区别</strong>：通道指令是通道执行的，I/O指令是CPU执行的。</li>
<li><strong>作用</strong>：指明数据首地址、传送字节数、操作命令等。</li>
<li><strong>通道程序</strong>：由通道指令组成，存放在主存中。</li>
</ul>
</li>
</ul>
<p><strong>2. I/O硬件</strong></p>
<ul>
<li>包括<strong>接口模块</strong>（含数据通路、控制通路、逻辑电路）和<strong>I/O设备</strong>。</li>
<li><strong>连接方式</strong>：
<ul>
<li><strong>辐射式</strong>（早期）：每台设备一套控制线，连线多，扩展难。</li>
<li><strong>总线式</strong>（现代）：所有设备通过接口挂在总线上。</li>
</ul>
</li>
</ul>
<h4 id="5-1-3-I-O设备与主机的联系方式">5.1.3 I/O设备与主机的联系方式</h4>
<p><strong>1. I/O设备编址方式</strong></p>
<ul>
<li><strong>统一编址</strong>（存储器映射I/O）：
<ul>
<li>将I/O地址看作存储器地址的一部分。</li>
<li><strong>优点</strong>：无需专用I/O指令，访存指令即可操作I/O，指令集丰富。</li>
<li><strong>缺点</strong>：占用主存空间。</li>
</ul>
</li>
<li><strong>不统一编址</strong>（独立编址）：
<ul>
<li>I/O地址和存储器地址分开。</li>
<li><strong>优点</strong>：不占用主存空间。</li>
<li><strong>缺点</strong>：需要专用的I/O指令。</li>
</ul>
</li>
</ul>
<p><strong>2. 设备寻址</strong></p>
<ul>
<li>通过I/O指令中的<strong>设备码</strong>字段直接指出设备号。</li>
<li>接口电路中有设备选择电路来识别。</li>
</ul>
<p><strong>3. 传送方式</strong></p>
<ul>
<li><strong>并行传送</strong>：同时传送多位信息，传输速度较快，适合近距离传输。</li>
<li><strong>串行传送</strong>：一次只传送一位信息，传输速度较慢，适合远距离传输。</li>
</ul>
<p><strong>4. 联络方式</strong>（解决时序配合问题）</p>
<ul>
<li><strong>立即响应方式</strong>：接收到I/O指令时，立即响应，如指示灯的亮/灭。</li>
<li><strong>异步工作采用应答信号联络</strong>：
<ul>
<li>I/O设备与主机工作速度不匹配时，采用异步工作方式。</li>
<li>I/O设备与CPU各自独立工作，出现联络信号时才准备交换信息。</li>
<li>I/O设备接收数据时：
<ul>
<li>I/O接口接收CPU发送的数据，并发出“Ready”信号。</li>
<li>I/O设备从接口取出数据，并发出“Strobe”信号。</li>
</ul>
</li>
<li>I/O设备发送数据时
<ul>
<li>I/O设备向接口送数据，并发出“Strobe”信号。</li>
<li>CPU取走数据，接口向I/O设备发送“Ready”信号，通知其可继续送数据。</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/post_article/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/5-6.png" alt="图 5.6 异步并行“应答”联络方式"></p>
<ul>
<li><strong>同步工作采用同步时标联络</strong>：要求工作速度完全同步，配有专用时钟。</li>
</ul>
<p><strong>5. I/O 设备与主机的连接方式</strong></p>
<ul>
<li><strong>辐射式连接（分散连接）</strong>：
<ul>
<li>每台设备都配有一套控制线路和一组信号线。</li>
<li>不便于增删设备。</li>
<li>设备可移植性差。</li>
</ul>
</li>
<li><strong>总线连接</strong>：
<ul>
<li>I/O设备通过标准接口和一组总线和主机连接。</li>
<li>便于增删设备。</li>
<li>设备可移植性强。</li>
</ul>
</li>
</ul>
<h4 id="5-1-4-I-O设备与主机信息传送的控制方式">5.1.4 I/O设备与主机信息传送的控制方式</h4>
<p>主要介绍前三种：</p>
<ol>
<li><strong>程序查询方式</strong>：
<ul>
<li>从某一I/O设备读数据块到主存，等待I/O设备准备数据时，CPU一直处于踏步等待状态。</li>
<li>CPU通过程序<strong>不断查询</strong>I/O设备是否准备就绪。</li>
<li><strong>缺点</strong>：CPU“踏步”等待，串行工作，效率低。</li>
</ul>
</li>
</ol>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/post_article/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/5-9.png" alt="图 5.9 程序查询方式流程"></p>
<ol start="2">
<li><strong>程序中断方式</strong>：
<ul>
<li>将I/O设备的工作分为两个阶段
<ul>
<li>数据/自身准备阶段</li>
<li>与主机交换信息阶段</li>
</ul>
</li>
<li>I/O设备自身准备阶段，CPU 不进行查询</li>
<li>I/O设备与主机交换信息阶段，CPU 暂停现行程序，为I/O设备服务</li>
<li><strong>流程</strong>：发出启动设备的指令以后，CPU继续执行原来的程序，当外部设备准备好以后，向CPU提出一个中断请求，让CPU停止对当前程序的执行，转而和I/O设备进行数据交换。</li>
<li><strong>优点</strong>：消除了“踏步”，实现了CPU与I/O<strong>并行工作</strong>。</li>
<li><strong>缺点</strong>：每次传送都需要保护/恢复现场，开销大，不适合高速大数据传送。</li>
</ul>
</li>
</ol>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/post_article/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/5-10.png" alt="图 5.10 程序中断方式示意图"></p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/post_article/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/5-11.png" alt="图 5.11 程序中断方式流程"></p>
<ol start="3">
<li>
<p><strong>DMA方式</strong> (直接存储器存取)：</p>
<ul>
<li>主存与I/O之间建立<strong>直接数据通路</strong>。</li>
<li>主存和 I/O可通过DMA控制器直接进行数据交换，不中断现行程序，不需CPU参与。</li>
<li>采用周期挪用（周期窃取）的方式
<ul>
<li>若DMA和CPU同时访问主存，DMA优先占有总线。</li>
<li>窃取的时间一般为一个存取周期，称为窃取/挪用周期。</li>
<li>窃取周期内，CPU不能使用总线访问主存，但尚能做内部操作（如乘法运算）。</li>
</ul>
</li>
<li><strong>CPU 和 I/O 并行工作</strong>：通过指令预取，可加强CPU 和 I/O 在窃取周期内工作的并行性。</li>
<li><strong>优点</strong>：不需要CPU暂停现行程序（只需挪用存取周期），适合<strong>高速、成组</strong>数据传送。</li>
</ul>
</li>
<li>
<p><strong>三种方式的 CPU 工作效率比较</strong>：</p>
<ul>
<li><strong>程序查询方式</strong>：
<ul>
<li>CPU执行到一条I/O指令后，启动I/O。</li>
<li>I/O设备在进行自身准备时，CPU一直在查询等待。</li>
<li>直到数据传输完成，CPU才继续执行原程序。</li>
</ul>
</li>
<li><strong>程序中断方式</strong>：
<ul>
<li>CPU执行到一条I/O指令后，启动I/O。</li>
<li>启动I/O后，CPU接着执行原程序，I/O进行自身准备。</li>
<li>I/O准备完成，发出中断请求，CPU才会在某一指令的执行周期结束后，响应中断。</li>
</ul>
</li>
<li><strong>DMA方式</strong>：
<ul>
<li>CPU执行到一条I/O指令后，启动I/O。</li>
<li>启动I/O后，CPU接着执行原程序，I/O进行自身准备。</li>
<li>I/O准备完成，窃取一个/多个存取周期，在DMA控制器的控制下，完成一个字或多个字的信息交换。</li>
<li>在窃取周期内，CPU仍可执行不访问主存的操作。</li>
</ul>
</li>
</ul>
</li>
</ol>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/post_article/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/5-12.png" alt="图 5.12 三种方式的CPU工作效率比较"></p>
<h3 id="5-2-I-O-设备">5.2 I/O 设备</h3>
<h4 id="5-2-1-概述">5.2.1 概述</h4>
<ul>
<li>I/O设备（外设）大致分为三类：
<ol>
<li><strong>人机交互设备</strong>：键盘、鼠标、显示器、打印机等。</li>
<li><strong>计算机信息存储设备</strong>：磁盘、光盘、磁带（辅存）。</li>
<li><strong>机-机通信设备</strong>：Modem等。</li>
</ol>
</li>
</ul>
<h4 id="5-2-2-输入设备">5.2.2 输入设备</h4>
<ul>
<li><strong>键盘</strong>：最普遍。分为编码键盘（硬件产生编码）和非编码键盘（软件扫描）。</li>
<li><strong>鼠标</strong>：机械式、光电式。</li>
<li><strong>触摸屏</strong>：电阻式、电容式等。</li>
</ul>
<h4 id="5-2-3-输出设备">5.2.3 输出设备</h4>
<p><strong>1. 显示设备</strong></p>
<ul>
<li><strong>CRT显示器</strong>：
<ul>
<li><strong>原理</strong>：电子枪发射电子束轰击荧光屏。</li>
<li><strong>扫描方式</strong>：
<ul>
<li><strong>光栅扫描</strong>：电子束按轨迹扫描（电视原理），需不断刷新。</li>
<li><strong>随机扫描</strong>：电子束像画笔一样画图（矢量法）。</li>
</ul>
</li>
<li><strong>字符显示器</strong>：
<ul>
<li><strong>VRAM (刷新存储器)</strong>：存放字符的ASCII码。容量 = 行 × 列 × 属性位。</li>
<li><strong>字符发生器 (ROM)</strong>：将ASCII码转换为点阵信息（如7×9点阵）。</li>
<li><strong>CRT控制器</strong>：控制扫描时序和同步。</li>
</ul>
</li>
<li><strong>图形显示器</strong>：主观图像（点线面组合）。</li>
<li><strong>图像显示器</strong>：客观图像（照片）。需<strong>灰度</strong>、<strong>真彩色</strong>等技术。</li>
</ul>
</li>
</ul>
<p><strong>2. 打印设备</strong></p>
<ul>
<li><strong>击打式</strong>：
<ul>
<li><strong>点阵针式打印机</strong>：利用钢针撞击色带。结构简单，可打多层，但噪声大、质量一般。</li>
</ul>
</li>
<li><strong>非击打式</strong>：
<ul>
<li><strong>激光打印机</strong>：激光扫描+电子照相技术。质量好、速度快、无噪声。页式输出。</li>
<li><strong>喷墨打印机</strong>：喷射墨水。印字质量接近激光，价格便宜。</li>
</ul>
</li>
</ul>
<h4 id="5-2-4-其他-I-O-设备">5.2.4 其他 I/O 设备</h4>
<p>除了人机交互设备（键盘、鼠标、显示器、打印机），还有以下重要设备：</p>
<ol>
<li>
<p><strong>终端设备 (Terminal)</strong></p>
<ul>
<li>由显示器和键盘组成的一套独立完整的I/O设备。</li>
<li>通过标准接口连接到远离主机的地方（远程）。</li>
<li>功能比普通显示器复杂，具备显示控制、存储、键盘管理及通信控制能力。</li>
</ul>
</li>
<li>
<p><strong>A/D 和 D/A 转换器</strong> (用于过程控制)</p>
<ul>
<li><strong>A/D (模拟/数字转换器)</strong>：将模拟量（电压、温度等）转换为数字量。属于<strong>输入设备</strong>。</li>
<li><strong>D/A (数字/模拟转换器)</strong>：将计算机输出的数字量转换为模拟量（控制电机转速等）。属于<strong>输出设备</strong>。</li>
</ul>
</li>
<li>
<p><strong>汉字处理设备</strong></p>
<ul>
<li><strong>汉字编码</strong>：
<ul>
<li><strong>输入码</strong>：用于输入（拼音、五笔）。</li>
<li><strong>内码</strong>：计算机内部存储、处理汉字用的代码（如GB2312）。通常用两个字节表示，最高位为1（区别于ASCII）。</li>
<li><strong>字形码</strong>：用于显示和打印（点阵信息）。</li>
</ul>
</li>
<li><strong>汉字输出</strong>：需要<strong>字库</strong>支持，将内码转换为字形码（点阵）输出。</li>
</ul>
</li>
</ol>
<h4 id="5-2-5-多媒体技术">5.2.5 多媒体技术</h4>
<ol>
<li><strong>定义</strong>：计算机技术与声、像技术的结合。将文字、图形、图像、音频、视频等多种媒体信息综合处理。</li>
<li><strong>关键技术</strong>：
<ul>
<li><strong>数据压缩/解压缩</strong>：图像和视频数据量极大，必须压缩（如JPEG, MPEG标准）。</li>
<li><strong>专用芯片</strong>：用于实时的信号处理。</li>
<li><strong>大容量存储</strong>：如大容量硬盘、光盘。</li>
<li><strong>多媒体软件</strong>：驱动程序、创作工具、应用软件。</li>
</ul>
</li>
</ol>
<h3 id="5-3-I-O-接口">5.3 I/O 接口</h3>
<h4 id="5-3-1-概述">5.3.1 概述</h4>
<ul>
<li><strong>接口 (Interface)</strong>：主机与I/O设备之间的硬件电路+软件控制。</li>
<li><strong>为什么要设置接口？</strong>
<ol>
<li>实现<strong>设备选择</strong>（选址）。</li>
<li>实现<strong>速度匹配</strong>（数据缓冲）。</li>
<li>实现<strong>数据格式转换</strong>（串-并）。</li>
<li>实现<strong>电平转换</strong>。</li>
<li>传送<strong>控制命令</strong>。</li>
<li>监视<strong>设备状态</strong>。</li>
</ol>
</li>
<li><strong>端口 (Port)</strong>：接口中的寄存器（数据端口、控制端口、状态端口）。</li>
</ul>
<h4 id="5-3-2-接口的功能和组成">5.3.2 接口的功能和组成</h4>
<ul>
<li><strong>总线连接方式</strong>：数据线、设备选择线、命令线、状态线。</li>
<li><strong>核心功能模块</strong>：
<ol>
<li><strong>设备选择电路</strong>：识别设备地址（选址）。</li>
<li><strong>命令寄存器/译码器</strong>：存放/解析CPU命令。</li>
<li><strong>数据缓冲寄存器 (DBR)</strong>：暂存数据，匹配速度。</li>
<li><strong>设备状态标记</strong>：
<ul>
<li><strong>D (完成触发器)</strong>：D=1表示准备就绪。</li>
<li><strong>B (工作触发器)</strong>：B=1表示正在忙。</li>
<li><strong>INTR (中断请求)</strong>：向CPU发中断。</li>
<li><strong>MASK (屏蔽)</strong>：屏蔽中断。</li>
</ul>
</li>
</ol>
</li>
</ul>
<h4 id="5-3-3-接口类型">5.3.3 接口类型</h4>
<ul>
<li>按数据传送：并行接口、串行接口。</li>
<li>按功能灵活性：可编程接口、不可编程接口。</li>
<li>按通用性：通用接口、专用接口。</li>
<li>按控制方式：程序型接口、DMA型接口。</li>
</ul>
<h3 id="5-4-程序查询方式">5.4 程序查询方式</h3>
<h4 id="5-4-1-程序查询流程">5.4.1 程序查询流程</h4>
<p>程序查询方式的核心是 <strong>CPU 不断地询问 I/O 设备：“你好了没？”</strong>。整个过程是串行的。</p>
<p><strong>1. 核心思想</strong><br>
CPU 暂时停止现行程序的执行，运行一段专门的<strong>查询程序</strong>。该程序不断读取 I/O 接口中的状态标记，直到设备准备就绪，才进行数据传送。</p>
<p><strong>2. 详细步骤</strong><br>
假设要将数据从 I/O 设备读入 CPU：</p>
<ul>
<li>
<p><strong>Step 1: 预置 (初始化)</strong></p>
<ul>
<li><strong>保存寄存器</strong>：因为查询程序要用到 CPU 的寄存器，所以先把寄存器里原有的内容保存起来（如压入堆栈）。</li>
<li><strong>设置计数器</strong>：要传多少个数据？设置好计数值。</li>
<li><strong>设置内存首址</strong>：数据读进来放哪？设置好主存缓冲区的首地址。</li>
</ul>
</li>
<li>
<p><strong>Step 2: 启动设备</strong></p>
<ul>
<li>CPU 向 I/O 接口发送“启动”指令（置位接口中的工作触发器 B，复位完成触发器 D）。</li>
</ul>
</li>
<li>
<p><strong>Step 3: 循环查询 (踏步等待)</strong></p>
<ul>
<li><strong>读状态</strong>：CPU 读取接口中的状态标记（通常是 D 标记）。</li>
<li><strong>判断</strong>：
<ul>
<li>如果 <strong>D=0</strong> (未就绪)：CPU 跳转回“读状态”指令，<strong>反复循环</strong>。这一步被称为“踏步”或“忙等” (Busy Wait)，是查询方式效率低下的根源。</li>
<li>如果 <strong>D=1</strong> (就绪)：跳出循环，进入下一步。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Step 4: 数据传送</strong></p>
<ul>
<li>CPU 从接口的数据缓冲寄存器 (DBR) 中读取一个数据。</li>
<li>将数据写入主存指定单元。</li>
</ul>
</li>
<li>
<p><strong>Step 5: 修改参数</strong></p>
<ul>
<li>主存地址加 1。</li>
<li>计数器减 1。</li>
</ul>
</li>
<li>
<p><strong>Step 6: 判断结束</strong></p>
<ul>
<li>检查计数器是否为 0。</li>
<li><strong>不为 0</strong>：说明还有数据没传完，返回 Step 2 或 Step 3（视具体设备是否需要重新启动）。</li>
<li><strong>为 0</strong>：传送结束。</li>
</ul>
</li>
<li>
<p><strong>Step 7: 结束</strong></p>
<ul>
<li>恢复寄存器内容（出栈）。</li>
<li>继续执行原来的主程序。</li>
</ul>
</li>
</ul>
<p><strong>3. 总结</strong></p>
<ul>
<li><strong>优点</strong>：硬件结构最简单，控制容易。</li>
<li><strong>缺点</strong>：CPU 在设备准备期间处于“踏步”状态，<strong>极大地浪费了 CPU 资源</strong>，CPU 与 I/O 无法并行工作。</li>
</ul>
<h4 id="5-4-2-程序查询方式的接口电路">5.4.2 程序查询方式的接口电路</h4>
<p>为了配合上述流程，接口电路通常包含：</p>
<ol>
<li><strong>设备选择电路</strong>：识别地址线上的设备号。</li>
<li><strong>数据缓冲寄存器 (DBR)</strong>：暂存数据。</li>
<li><strong>状态标记</strong>：
<ul>
<li><strong>D (Done, 完成触发器)</strong>：D=1 表示准备好。</li>
<li><strong>B (Busy, 工作触发器)</strong>：B=1 表示正在忙。</li>
</ul>
</li>
<li><strong>控制逻辑</strong>：接收 CPU 的启动命令，置位 B，复位 D；设备工作结束后，置位 D，复位 B。</li>
</ol>
<h3 id="5-5-程序中断方式">5.5 程序中断方式</h3>
<h4 id="5-5-1-中断的概念">5.5.1 中断的概念</h4>
<p>CPU在执行程序时，出现异常或特殊请求，暂停现行程序，转去处理该请求，处理完后返回原断点继续执行。</p>
<h4 id="5-5-2-I-O中断的产生">5.5.2 I/O中断的产生</h4>
<p>为了解决程序查询方式中CPU“踏步”等待的问题。CPU启动设备后继续执行主程序，设备准备好后主动发<strong>中断请求</strong>。</p>
<h4 id="5-5-3-程序中断方式的接口电路">5.5.3 程序中断方式的接口电路</h4>
<p>为了配合中断，接口需增加：</p>
<ol>
<li><strong>中断请求触发器 (INTR)</strong> 和 <strong>屏蔽触发器 (MASK)</strong>。</li>
<li><strong>排队器</strong>：解决多个中断源同时请求的判优问题。
<ul>
<li><strong>硬件实现</strong>：链式排队电路（分散在接口）或集中在CPU内。</li>
</ul>
</li>
<li><strong>中断向量地址形成部件</strong>（设备编码器）：
<ul>
<li><strong>硬件向量法</strong>：由硬件产生<strong>向量地址</strong>，该地址指向中断服务程序的入口地址（或跳转指令）。</li>
</ul>
</li>
</ol>
<h4 id="5-5-4-I-O中断处理过程">5.5.4 I/O中断处理过程</h4>
<ol>
<li><strong>CPU响应中断的条件</strong>：
<ul>
<li>允许中断触发器 <strong>EINT = 1</strong>（开中断）。</li>
<li>指令执行阶段结束时刻。</li>
</ul>
</li>
<li><strong>处理流程</strong>：
<ul>
<li><strong>中断请求</strong>：设备发INTR。</li>
<li><strong>中断判优</strong>：排队器决定响应哪个。</li>
<li><strong>中断响应</strong>：
<ul>
<li>CPU发中断响应信号 <strong>INTA</strong>。</li>
<li><strong>关中断</strong>（置EINT=0，防止更高优先级打断，或在单重中断中防止同级打断）。</li>
<li><strong>保存断点</strong>（PC推入堆栈）。</li>
<li>获取<strong>向量地址</strong>，转入中断服务程序。</li>
</ul>
</li>
<li><strong>中断服务</strong>：
<ul>
<li><strong>保护现场</strong>（PUSH寄存器）。</li>
<li><strong>设备服务</strong>（真正的I/O数据传送）。</li>
<li><strong>恢复现场</strong>（POP寄存器）。</li>
<li><strong>开中断</strong>。</li>
<li><strong>中断返回</strong>（IRET，恢复PC）。</li>
</ul>
</li>
</ul>
</li>
</ol>
<ul>
<li><strong>单重中断 vs 多重中断</strong>：
<ul>
<li><strong>单重中断</strong>：处理中断时不能被新的中断打断。服务程序执行完才开中断。</li>
<li><strong>多重中断（中断嵌套）</strong>：允许级别更高的中断打断低级别中断。保护现场后<strong>立即开中断</strong>。</li>
</ul>
</li>
</ul>
<h4 id="5-5-5-中断服务程序的流程">5.5.5 中断服务程序的流程</h4>
<p>中断服务程序是 CPU 响应中断后执行的一段程序，其流程一般分为四大部分：</p>
<ol>
<li>
<p><strong>保护现场</strong></p>
<ul>
<li><strong>含义</strong>：保存当前 CPU 的状态，以便中断处理完后能回得来。</li>
<li><strong>内容</strong>：
<ul>
<li><strong>程序断点</strong> (PC)：通常由<strong>硬件</strong>（中断隐指令）自动保存到堆栈。</li>
<li><strong>通用寄存器 &amp; 状态寄存器</strong>：通常由<strong>软件</strong>（服务程序开头的 PUSH 指令）保存。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>中断服务 (核心部分)</strong></p>
<ul>
<li>执行真正的 I/O 操作。例如：从接口读取数据放入 CPU 寄存器，再写入主存；或者将主存数据送入打印机接口。</li>
<li><em>注</em>：如果是<strong>多重中断</strong>，通常在此阶段之前或之中执行“开中断”指令，允许更高优先级的请求打断。</li>
</ul>
</li>
<li>
<p><strong>恢复现场</strong></p>
<ul>
<li>在服务程序结束前，将保存在堆栈中的寄存器内容弹回 (POP)，使 CPU 恢复到中断前的状态。</li>
</ul>
</li>
<li>
<p><strong>中断返回</strong></p>
<ul>
<li>执行中断返回指令 (如 IRET)。</li>
<li>该指令通常包含两个动作：
<ul>
<li>返回断点（恢复 PC）。</li>
<li>开中断（允许响应新的中断）。</li>
</ul>
</li>
</ul>
</li>
</ol>
<h3 id="5-6-DMA-方式">5.6 DMA 方式</h3>
<h4 id="5-6-1-DMA-方式的特点">5.6.1 DMA 方式的特点</h4>
<ul>
<li><strong>直接存储器存取</strong>：主存与I/O设备间建立直接数据通路。</li>
<li><strong>不经过CPU</strong>：数据不经过CPU寄存器（ACC等）。</li>
<li><strong>不需中断服务程序</strong>：仅在传送开始（预处理）和结束（后处理）时需要CPU干预。</li>
<li><strong>三种DMA传送方法</strong>：
<ol>
<li><strong>停止CPU访问主存</strong>：DMA工作时，CPU完全停止访存。</li>
<li><strong>周期挪用（周期窃取）</strong>：
<ul>
<li>当I/O有请求时，挪用一个<strong>存取周期</strong>。</li>
<li>若CPU此时不访存，无冲突。</li>
<li>若CPU正在访存，等待CPU存取周期结束。</li>
<li>若同时请求，<strong>I/O优先</strong>（因为I/O数据可能丢失）。</li>
</ul>
</li>
<li><strong>DMA与CPU交替访问</strong>：适用于CPU工作周期比主存存取周期长的情况。</li>
</ol>
</li>
</ul>
<h4 id="5-6-2-DMA-接口的功能和组成">5.6.2 DMA 接口的功能和组成</h4>
<ul>
<li><strong>功能</strong>：
<ol>
<li>向CPU申请DMA。</li>
<li>处理总线控制权转交。</li>
<li>管理总线，控制传送。</li>
<li>修改地址和计数器。</li>
</ol>
</li>
<li><strong>组成</strong>：
<ol>
<li><strong>主存地址寄存器 (AR)</strong>：存放主存地址。</li>
<li><strong>字计数器 (WC)</strong>：记录传送字数。</li>
<li><strong>数据缓冲寄存器 (BR)</strong>。</li>
<li><strong>DMA控制逻辑</strong>。</li>
<li><strong>中断机构</strong>：用于传送结束后的处理。</li>
<li><strong>设备地址寄存器 (DAR)</strong>。</li>
</ol>
</li>
</ul>
<h4 id="5-6-3-DMA-的工作过程">5.6.3 DMA 的工作过程</h4>
<ol>
<li><strong>预处理</strong>：CPU执行几条指令，初始化DMA（设置AR, WC, DAR，启动设备）。</li>
<li><strong>数据传送</strong>：
<ul>
<li>设备准备好字 -&gt; 发DREQ（DMA请求）。</li>
<li>DMA回DACK，发HRQ（总线请求）给CPU。</li>
<li>CPU回HLDA（总线响应），让出总线。</li>
<li>DMA控制数据直接在设备和主存间传送。</li>
<li>修改AR（+1），修改WC（-1）。</li>
<li>循环直到WC=0。</li>
</ul>
</li>
<li><strong>后处理</strong>：
<ul>
<li>WC=0（溢出），DMA发中断请求。</li>
<li>CPU执行中断服务程序，做结束处理（校验、测试等）。</li>
</ul>
</li>
</ol>
<ul>
<li><strong>DMA与中断方式的区别</strong>：
<ul>
<li>中断是<strong>程序</strong>切换，DMA是<strong>硬件</strong>占用总线。</li>
<li>中断响应在<strong>指令</strong>执行结束，DMA响应在<strong>存取周期</strong>结束。</li>
<li>中断处理异常和I/O，DMA只处理I/O数据传送。</li>
<li>DMA优先级高于中断。</li>
</ul>
</li>
</ul>
<h4 id="5-6-4-DMA-接口的类型">5.6.4 DMA 接口的类型</h4>
<p>根据 DMA 接口连接设备的方式和逻辑，主要分为两类：</p>
<ol>
<li>
<p><strong>选择型 DMA 接口 (Selector Mode)</strong></p>
<ul>
<li><strong>物理连接</strong>：物理上可以连接多个设备（如磁盘、磁带）。</li>
<li><strong>逻辑工作</strong>：在<strong>某一个时间段内，只能为一个设备服务</strong>。</li>
<li><strong>特点</strong>：一旦选中某个设备，该设备就独占 DMA 接口，直到一批数据传送完毕。</li>
<li><strong>适用</strong>：<strong>高速</strong>设备（因为高速设备传输时不能被打断）。</li>
</ul>
</li>
<li>
<p><strong>多路型 DMA 接口 (Multiplexer Mode)</strong></p>
<ul>
<li><strong>物理连接</strong>：连接多个设备。</li>
<li><strong>逻辑工作</strong>：不仅在物理上连接多个，而且在逻辑上允许这些设备<strong>同时工作</strong>。</li>
<li><strong>原理</strong>：各设备通过<strong>字节交叉</strong>（分时）的方式复用 DMA 接口。即设备 A 传一个字节，设备 B 传一个字节…</li>
<li><strong>适用</strong>：<strong>中、低速</strong>设备（数据准备时间较长，DMA 接口有空闲时间服务其他设备）。</li>
</ul>
</li>
</ol>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://www.sparklerain.top">寂夜璃殇情</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://www.sparklerain.top/posts/a7cddde5/">https://www.sparklerain.top/posts/a7cddde5/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://www.sparklerain.top" target="_blank">北城烟雨阁</a>！</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="/img/posts/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86.jpg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/posts/5c14eb1b/" title="计算机组成原理（3）：中央处理器"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/posts/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">计算机组成原理（3）：中央处理器</div></div><div class="info-2"><div class="info-item-1">第6章 计算机的运算方法 本章核心：计算机内部如何表示数据（有符号/无符号、定点/浮点），以及如何进行加减乘除运算。 6.0 （补充）非数值数据的表示、数据信息的校验 6.0.1 字符表示  非数值数据：没有数值大小之分，如字符和汉字等。 ASCII码：使用7bit表示128个字符（从000 0000 到 111 1111）。计算机中数据存储以字节为单位，故字节最高位（Most Significant Bit，MSB ）为0。单字节编码。  ASCII码 - 官网 ASCII码 - 菜鸟驿站 6.0.2 汉字编码  汉字输入码：使用英文键盘输入汉字时所使用的编码（输入法：将从键盘输入的汉字输入码转化为汉字的机器内码）。 汉字交换码：不同的具有汉字处理功能的计算机系统之间在交换汉字信息时所用的代码标准：国标码。 区位码：  为检索方便，采用94X94=8836的二维矩阵对汉字、特殊符号、数字、英文字符、制表符等进行编码。 每一行称为“区”，每一列称为“位”，编号从1开始。 区号和位号的组合（4位10进制）构成该字的区位码。比如“中”（区位码）：5448。 双字节编码 同一英文字母、...</div></div></div></a><a class="pagination-related" href="/posts/77b8fe83/" title="计算机组成原理（1）：概论"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/posts/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">计算机组成原理（1）：概论</div></div><div class="info-2"><div class="info-item-1">第1章 计算机系统概论 1.1 计算机系统简介 计算机系统由硬件和软件两大部分组成。计算机性能的好坏取决于“软”、“硬”件功能的总和。 1.1.1 计算机的软硬件概念 1. 硬件 (Hardware)  定义：计算机的实体部分，由看得见、摸得着的各种电子元器件（如光、电、机设备）组成。 例子：主机、外部设备等。 核心作用：提供物质基础。  2. 软件 (Software)  定义：看不见、摸不着的，由人们事先编制的具有各类特殊功能的程序组成。 载体：通常存放在各类媒体（RAM、ROM、磁盘、光盘等）中。 核心作用：  充分发挥硬件功能，提高工作效率。 局部模拟人类思维活动。   理解：如果没有软件，硬件就是一堆废铁；软件必须依托硬件才能发挥作用。  3. 软件的分类  系统软件 (System Software)：  作用：管理整个计算机系统，监视服务，使系统资源得到合理调度，高效运行。 包含：标准程序库、语言处理程序（如汇编程序、编译程序）、操作系统（批处理、分时、实时）、服务程序（诊断、调试）、数据库管理系统、网络软件等。   应用软件 (Application Softwa...</div></div></div></a></nav><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="giscus-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/Profile_Picture.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">寂夜璃殇情</div><div class="author-info-description">此情可待成追忆，只是当时已惘然</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">18</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/silentnight-sparklerain"><i class="fab fa-github"></i><span>GitHub关注</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/silentnight-sparklerain" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="https://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=964476541@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a><a class="social-icon" href="https://space.bilibili.com/1407889438?spm_id_from=333.1387.0.0" target="_blank" title="B站"><i class="fab fa-bilibili" style="color: #fb7299;"></i></a><a class="social-icon" href="https://x.com/Sparklerain1012" target="_blank" title="Twitter"><i class="fab fa-x-twitter" style="color: #000000;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到我的个人博客</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC3%E7%AB%A0-%E7%B3%BB%E7%BB%9F%E6%80%BB%E7%BA%BF"><span class="toc-text">第3章 系统总线</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E6%80%BB%E7%BA%BF%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-text">3.1 总线的基本概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E6%80%BB%E7%BA%BF%E7%9A%84%E5%88%86%E7%B1%BB"><span class="toc-text">3.2 总线的分类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-1-%E7%89%87%E5%86%85%E6%80%BB%E7%BA%BF"><span class="toc-text">3.2.1 片内总线</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-2-%E7%B3%BB%E7%BB%9F%E6%80%BB%E7%BA%BF"><span class="toc-text">3.2.2 系统总线</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-3-%E9%80%9A%E4%BF%A1%E6%80%BB%E7%BA%BF"><span class="toc-text">3.2.3 通信总线</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E6%80%BB%E7%BA%BF%E7%89%B9%E6%80%A7%E5%8F%8A%E6%80%A7%E8%83%BD%E6%8C%87%E6%A0%87"><span class="toc-text">3.3 总线特性及性能指标</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-1-%E6%80%BB%E7%BA%BF%E7%89%B9%E6%80%A7"><span class="toc-text">3.3.1 总线特性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-2-%E6%80%BB%E7%BA%BF%E6%80%A7%E8%83%BD%E6%8C%87%E6%A0%87"><span class="toc-text">3.3.2 总线性能指标</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-3-%E6%80%BB%E7%BA%BF%E6%A0%87%E5%87%86"><span class="toc-text">3.3.3 总线标准</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-%E6%80%BB%E7%BA%BF%E7%BB%93%E6%9E%84"><span class="toc-text">3.4 总线结构</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-1-%E5%8D%95%E6%80%BB%E7%BA%BF%E7%BB%93%E6%9E%84"><span class="toc-text">3.4.1 单总线结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-2-%E5%A4%9A%E6%80%BB%E7%BA%BF%E7%BB%93%E6%9E%84"><span class="toc-text">3.4.2 多总线结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-3-%E6%80%BB%E7%BA%BF%E7%BB%93%E6%9E%84%E4%B8%BE%E4%BE%8B"><span class="toc-text">3.4.3 总线结构举例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-%E6%80%BB%E7%BA%BF%E6%8E%A7%E5%88%B6"><span class="toc-text">3.5 总线控制</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-5-1-%E6%80%BB%E7%BA%BF%E5%88%A4%E4%BC%98%E6%8E%A7%E5%88%B6"><span class="toc-text">3.5.1 总线判优控制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-5-2-%E6%80%BB%E7%BA%BF%E9%80%9A%E4%BF%A1%E6%8E%A7%E5%88%B6"><span class="toc-text">3.5.2 总线通信控制</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC4%E7%AB%A0-%E5%AD%98%E5%82%A8%E5%99%A8"><span class="toc-text">第4章 存储器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E6%A6%82%E8%BF%B0"><span class="toc-text">4.1 概述</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-1-%E5%AD%98%E5%82%A8%E5%99%A8%E5%88%86%E7%B1%BB"><span class="toc-text">4.1.1 存储器分类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-2-%E5%AD%98%E5%82%A8%E5%99%A8%E7%9A%84%E5%B1%82%E6%AC%A1%E7%BB%93%E6%9E%84"><span class="toc-text">4.1.2 存储器的层次结构</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E4%B8%BB%E5%AD%98%E5%82%A8%E5%99%A8"><span class="toc-text">4.2 主存储器</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-1-%E6%A6%82%E8%BF%B0"><span class="toc-text">4.2.1 概述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-2-%E5%8D%8A%E5%AF%BC%E4%BD%93%E5%AD%98%E5%82%A8%E8%8A%AF%E7%89%87%E7%AE%80%E4%BB%8B"><span class="toc-text">4.2.2 半导体存储芯片简介</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-3-%E9%9A%8F%E6%9C%BA%E5%AD%98%E5%8F%96%E5%AD%98%E5%82%A8%E5%99%A8-RAM"><span class="toc-text">4.2.3 随机存取存储器 (RAM)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-4-%E5%8F%AA%E8%AF%BB%E5%AD%98%E5%82%A8%E5%99%A8-ROM"><span class="toc-text">4.2.4 只读存储器 (ROM)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-5-%E5%AD%98%E5%82%A8%E5%99%A8%E4%B8%8E-CPU-%E7%9A%84%E8%BF%9E%E6%8E%A5"><span class="toc-text">4.2.5 存储器与 CPU 的连接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-6-%E5%AD%98%E5%82%A8%E5%99%A8%E7%9A%84%E6%A0%A1%E9%AA%8C-%E6%B1%89%E6%98%8E%E7%A0%81"><span class="toc-text">4.2.6 存储器的校验 (汉明码)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-7-%E6%8F%90%E9%AB%98%E8%AE%BF%E5%AD%98%E9%80%9F%E5%BA%A6%E7%9A%84%E6%8E%AA%E6%96%BD"><span class="toc-text">4.2.7 提高访存速度的措施</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-%E9%AB%98%E9%80%9F%E7%BC%93%E5%86%B2%E5%AD%98%E5%82%A8%E5%99%A8-Cache"><span class="toc-text">4.3 高速缓冲存储器 (Cache)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-1-%E6%A6%82%E8%BF%B0"><span class="toc-text">4.3.1 概述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-2-Cache-%E4%B8%BB%E5%AD%98%E5%9C%B0%E5%9D%80%E6%98%A0%E5%B0%84"><span class="toc-text">4.3.2 Cache-主存地址映射</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-3-%E6%9B%BF%E6%8D%A2%E7%AD%96%E7%95%A5"><span class="toc-text">4.3.3 替换策略</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-%E8%BE%85%E5%8A%A9%E5%AD%98%E5%82%A8%E5%99%A8"><span class="toc-text">4.4 辅助存储器</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-1-%E6%A6%82%E8%BF%B0"><span class="toc-text">4.4.1 概述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-2-%E7%A3%81%E8%AE%B0%E5%BD%95%E5%8E%9F%E7%90%86%E5%92%8C%E8%AE%B0%E5%BD%95%E6%96%B9%E5%BC%8F"><span class="toc-text">4.4.2 磁记录原理和记录方式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-3-%E7%A1%AC%E7%A3%81%E7%9B%98%E5%AD%98%E5%82%A8%E5%99%A8"><span class="toc-text">4.4.3 硬磁盘存储器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-4-%E8%BD%AF%E7%A3%81%E7%9B%98%E5%AD%98%E5%82%A8%E5%99%A8"><span class="toc-text">4.4.4 软磁盘存储器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-5-%E7%A3%81%E5%B8%A6%E5%AD%98%E5%82%A8%E5%99%A8"><span class="toc-text">4.4.5 磁带存储器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-6-%E5%BE%AA%E7%8E%AF%E5%86%97%E4%BD%99%E6%A0%A1%E9%AA%8C-CRC"><span class="toc-text">4.4.6 循环冗余校验 (CRC)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-7-%E5%85%89%E7%9B%98%E5%AD%98%E5%82%A8%E5%99%A8"><span class="toc-text">4.4.7 光盘存储器</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC5%E7%AB%A0-%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F"><span class="toc-text">第5章 输入输出系统</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E6%A6%82%E8%BF%B0"><span class="toc-text">5.1 概述</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-1-%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%8F%91%E5%B1%95%E6%A6%82%E5%86%B5"><span class="toc-text">5.1.1 输入输出系统的发展概况</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-2-%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%BB%84%E6%88%90"><span class="toc-text">5.1.2 输入输出系统的组成</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-3-I-O%E8%AE%BE%E5%A4%87%E4%B8%8E%E4%B8%BB%E6%9C%BA%E7%9A%84%E8%81%94%E7%B3%BB%E6%96%B9%E5%BC%8F"><span class="toc-text">5.1.3 I&#x2F;O设备与主机的联系方式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-4-I-O%E8%AE%BE%E5%A4%87%E4%B8%8E%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF%E4%BC%A0%E9%80%81%E7%9A%84%E6%8E%A7%E5%88%B6%E6%96%B9%E5%BC%8F"><span class="toc-text">5.1.4 I&#x2F;O设备与主机信息传送的控制方式</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-I-O-%E8%AE%BE%E5%A4%87"><span class="toc-text">5.2 I&#x2F;O 设备</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2-1-%E6%A6%82%E8%BF%B0"><span class="toc-text">5.2.1 概述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2-2-%E8%BE%93%E5%85%A5%E8%AE%BE%E5%A4%87"><span class="toc-text">5.2.2 输入设备</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2-3-%E8%BE%93%E5%87%BA%E8%AE%BE%E5%A4%87"><span class="toc-text">5.2.3 输出设备</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2-4-%E5%85%B6%E4%BB%96-I-O-%E8%AE%BE%E5%A4%87"><span class="toc-text">5.2.4 其他 I&#x2F;O 设备</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2-5-%E5%A4%9A%E5%AA%92%E4%BD%93%E6%8A%80%E6%9C%AF"><span class="toc-text">5.2.5 多媒体技术</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-I-O-%E6%8E%A5%E5%8F%A3"><span class="toc-text">5.3 I&#x2F;O 接口</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-3-1-%E6%A6%82%E8%BF%B0"><span class="toc-text">5.3.1 概述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-3-2-%E6%8E%A5%E5%8F%A3%E7%9A%84%E5%8A%9F%E8%83%BD%E5%92%8C%E7%BB%84%E6%88%90"><span class="toc-text">5.3.2 接口的功能和组成</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-3-3-%E6%8E%A5%E5%8F%A3%E7%B1%BB%E5%9E%8B"><span class="toc-text">5.3.3 接口类型</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4-%E7%A8%8B%E5%BA%8F%E6%9F%A5%E8%AF%A2%E6%96%B9%E5%BC%8F"><span class="toc-text">5.4 程序查询方式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-4-1-%E7%A8%8B%E5%BA%8F%E6%9F%A5%E8%AF%A2%E6%B5%81%E7%A8%8B"><span class="toc-text">5.4.1 程序查询流程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-4-2-%E7%A8%8B%E5%BA%8F%E6%9F%A5%E8%AF%A2%E6%96%B9%E5%BC%8F%E7%9A%84%E6%8E%A5%E5%8F%A3%E7%94%B5%E8%B7%AF"><span class="toc-text">5.4.2 程序查询方式的接口电路</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-5-%E7%A8%8B%E5%BA%8F%E4%B8%AD%E6%96%AD%E6%96%B9%E5%BC%8F"><span class="toc-text">5.5 程序中断方式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-5-1-%E4%B8%AD%E6%96%AD%E7%9A%84%E6%A6%82%E5%BF%B5"><span class="toc-text">5.5.1 中断的概念</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-5-2-I-O%E4%B8%AD%E6%96%AD%E7%9A%84%E4%BA%A7%E7%94%9F"><span class="toc-text">5.5.2 I&#x2F;O中断的产生</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-5-3-%E7%A8%8B%E5%BA%8F%E4%B8%AD%E6%96%AD%E6%96%B9%E5%BC%8F%E7%9A%84%E6%8E%A5%E5%8F%A3%E7%94%B5%E8%B7%AF"><span class="toc-text">5.5.3 程序中断方式的接口电路</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-5-4-I-O%E4%B8%AD%E6%96%AD%E5%A4%84%E7%90%86%E8%BF%87%E7%A8%8B"><span class="toc-text">5.5.4 I&#x2F;O中断处理过程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-5-5-%E4%B8%AD%E6%96%AD%E6%9C%8D%E5%8A%A1%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%B5%81%E7%A8%8B"><span class="toc-text">5.5.5 中断服务程序的流程</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-6-DMA-%E6%96%B9%E5%BC%8F"><span class="toc-text">5.6 DMA 方式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-6-1-DMA-%E6%96%B9%E5%BC%8F%E7%9A%84%E7%89%B9%E7%82%B9"><span class="toc-text">5.6.1 DMA 方式的特点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-6-2-DMA-%E6%8E%A5%E5%8F%A3%E7%9A%84%E5%8A%9F%E8%83%BD%E5%92%8C%E7%BB%84%E6%88%90"><span class="toc-text">5.6.2 DMA 接口的功能和组成</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-6-3-DMA-%E7%9A%84%E5%B7%A5%E4%BD%9C%E8%BF%87%E7%A8%8B"><span class="toc-text">5.6.3 DMA 的工作过程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-6-4-DMA-%E6%8E%A5%E5%8F%A3%E7%9A%84%E7%B1%BB%E5%9E%8B"><span class="toc-text">5.6.4 DMA 接口的类型</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-post-series"><div class="item-headline"><i class="fa-solid fa-layer-group"></i><span>计算机组成原理笔记</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/edc0bf5c/" title="计算机组成原理（4）：控制单元"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/posts/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="计算机组成原理（4）：控制单元"></a><div class="content"><a class="title" href="/posts/edc0bf5c/" title="计算机组成原理（4）：控制单元">计算机组成原理（4）：控制单元</a><time datetime="2025-12-21T16:00:00.000Z" title="发表于 2025-12-22 00:00:00">2025-12-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/5c14eb1b/" title="计算机组成原理（3）：中央处理器"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/posts/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="计算机组成原理（3）：中央处理器"></a><div class="content"><a class="title" href="/posts/5c14eb1b/" title="计算机组成原理（3）：中央处理器">计算机组成原理（3）：中央处理器</a><time datetime="2025-12-20T16:00:00.000Z" title="发表于 2025-12-21 00:00:00">2025-12-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/a7cddde5/" title="计算机组成原理（2）：计算机系统的硬件结构"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/posts/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="计算机组成原理（2）：计算机系统的硬件结构"></a><div class="content"><a class="title" href="/posts/a7cddde5/" title="计算机组成原理（2）：计算机系统的硬件结构">计算机组成原理（2）：计算机系统的硬件结构</a><time datetime="2025-12-19T16:00:00.000Z" title="发表于 2025-12-20 00:00:00">2025-12-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/77b8fe83/" title="计算机组成原理（1）：概论"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/posts/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="计算机组成原理（1）：概论"></a><div class="content"><a class="title" href="/posts/77b8fe83/" title="计算机组成原理（1）：概论">计算机组成原理（1）：概论</a><time datetime="2025-12-18T16:00:00.000Z" title="发表于 2025-12-19 00:00:00">2025-12-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/8d4b7ae1/" title="计算机组成原理"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/posts/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="计算机组成原理"></a><div class="content"><a class="title" href="/posts/8d4b7ae1/" title="计算机组成原理">计算机组成原理</a><time datetime="2025-12-17T16:00:00.000Z" title="发表于 2025-12-18 00:00:00">2025-12-18</time></div></div></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/1f59513d/" title="2025年度总结"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/posts/2025.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2025年度总结"/></a><div class="content"><a class="title" href="/posts/1f59513d/" title="2025年度总结">2025年度总结</a><time datetime="2025-12-23T16:00:00.000Z" title="发表于 2025-12-24 00:00:00">2025-12-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/8d4b7ae1/" title="计算机组成原理"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/posts/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="计算机组成原理"/></a><div class="content"><a class="title" href="/posts/8d4b7ae1/" title="计算机组成原理">计算机组成原理</a><time datetime="2025-12-17T16:00:00.000Z" title="发表于 2025-12-18 00:00:00">2025-12-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/f0be246/" title="数据结构与基础算法"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/posts/DataStructures_and_Algorithm.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据结构与基础算法"/></a><div class="content"><a class="title" href="/posts/f0be246/" title="数据结构与基础算法">数据结构与基础算法</a><time datetime="2025-12-07T16:00:00.000Z" title="发表于 2025-12-08 00:00:00">2025-12-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/3fb56f9d/" title="离散数学"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/posts/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6.avif" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="离散数学"/></a><div class="content"><a class="title" href="/posts/3fb56f9d/" title="离散数学">离散数学</a><time datetime="2025-11-24T16:00:00.000Z" title="发表于 2025-11-25 00:00:00">2025-11-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/c23efd5b/" title="线性代数"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/posts/linear_algebra.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="线性代数"/></a><div class="content"><a class="title" href="/posts/c23efd5b/" title="线性代数">线性代数</a><time datetime="2025-11-23T16:00:00.000Z" title="发表于 2025-11-24 00:00:00">2025-11-24</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 By 寂夜璃殇情</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.1</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.2</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.2"></script><script src="/js/main.js?v=5.5.2"></script><script src="/js/tw_cn.js?v=5.5.2"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@19.1.3/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>(async () => {
  const showKatex = () => {
    document.querySelectorAll('#article-container .katex').forEach(el => el.classList.add('katex-show'))
  }

  if (!window.katex_js_css) {
    window.katex_js_css = true
    await btf.getCSS('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex.min.css')
    if (false) {
      await btf.getScript('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/contrib/copy-tex.min.js')
    }
  }

  showKatex()
})()</script><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = {"lang":"zh-CN","mapping":"pathname"}

  const getGiscusTheme = theme => theme === 'dark' ? 'dark' : 'light'

  const createScriptElement = config => {
    const ele = document.createElement('script')
    Object.entries(config).forEach(([key, value]) => {
      ele.setAttribute(key, value)
    })
    return ele
  }

  const loadGiscus = (el = document, key) => {
    const mappingConfig = isShuoshuo
      ? { 'data-mapping': 'specific', 'data-term': key }
      : { 'data-mapping': (option && option['data-mapping']) || 'pathname' }

    const giscusConfig = {
      src: 'https://giscus.app/client.js',
      'data-repo': 'silentnight-sparklerain/silentnight-sparklerain.github.io',
      'data-repo-id': 'R_kgDOQTYNtw',
      'data-category-id': 'DIC_kwDOQTYNt84Cxyqh',
      'data-theme': getGiscusTheme(document.documentElement.getAttribute('data-theme')),
      'data-reactions-enabled': '1',
      crossorigin: 'anonymous',
      async: true,
      ...option,
      ...mappingConfig
    }

    const scriptElement = createScriptElement(giscusConfig)

    el.querySelector('#giscus-wrap').appendChild(scriptElement)

    if (isShuoshuo) {
      window.shuoshuoComment.destroyGiscus = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }
  }

  const changeGiscusTheme = theme => {
    const iframe = document.querySelector('#giscus-wrap iframe')
    if (iframe) {
      const message = {
        giscus: {
          setConfig: {
            theme: getGiscusTheme(theme)
          }
        }
      }
      iframe.contentWindow.postMessage(message, 'https://giscus.app')
    }
  }

  btf.addGlobalFn('themeChange', changeGiscusTheme, 'giscus')

  if (isShuoshuo) {
    'Giscus' === 'Giscus'
      ? window.shuoshuoComment = { loadComment: loadGiscus }
      : window.loadOtherComment = loadGiscus
    return
  }

  if ('Giscus' === 'Giscus' || !true) {
    if (true) btf.loadComment(document.getElementById('giscus-wrap'), loadGiscus)
    else loadGiscus()
  } else {
    window.loadOtherComment = loadGiscus
  }
})()</script></div><script async src="//cn.vercount.one/js"></script><script>
var prevScrollpos = window.pageYOffset;
window.onscroll = function() {
  var currentScrollPos = window.pageYOffset;
  var nav = document.getElementById("nav");
  
  if (prevScrollpos > currentScrollPos) {
    // 向上滑，显示
    nav.style.top = "0";
  } else {
    // 向下滑，隐藏 (阈值 60px)
    if (currentScrollPos > 60) {
       nav.style.top = "-70px";
    }
  }
  prevScrollpos = currentScrollPos;
}
</script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/metingjs/dist/Meting.min.js"></script><script>(() => {
  const destroyAplayer = () => {
    if (window.aplayers) {
      for (let i = 0; i < window.aplayers.length; i++) {
        if (!window.aplayers[i].options.fixed) {
          window.aplayers[i].destroy()
        }
      }
    }
  }

  const runMetingJS = () => {
    typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()
  }

  btf.addGlobalFn('pjaxSend', destroyAplayer, 'destroyAplayer')
  btf.addGlobalFn('pjaxComplete', loadMeting, 'runMetingJS')
})()</script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"></script><script>(() => {
  const pjaxSelectors = ["meta[property=\"og:image\"]","meta[property=\"og:title\"]","meta[property=\"og:url\"]","meta[property=\"og:description\"]","link[rel=\"canonical\"]","head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

  window.pjax = new Pjax({
    elements: 'a:not([target="_blank"])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
  })

  const triggerPjaxFn = (val) => {
    if (!val) return
    Object.values(val).forEach(fn => {
      try {
        fn()
      } catch (err) {
        console.debug('Pjax callback failed:', err)
      }
    })
  }

  document.addEventListener('pjax:send', () => {
    // removeEventListener
    btf.removeGlobalFnEvent('pjaxSendOnce')
    btf.removeGlobalFnEvent('themeChange')

    // reset readmode
    const $bodyClassList = document.body.classList
    if ($bodyClassList.contains('read-mode')) $bodyClassList.remove('read-mode')

    triggerPjaxFn(window.globalFn.pjaxSend)
  })

  document.addEventListener('pjax:complete', () => {
    btf.removeGlobalFnEvent('pjaxCompleteOnce')
    document.querySelectorAll('script[data-pjax]').forEach(item => {
      const newScript = document.createElement('script')
      const content = item.text || item.textContent || item.innerHTML || ""
      Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
      newScript.appendChild(document.createTextNode(content))
      item.parentNode.replaceChild(newScript, item)
    })

    triggerPjaxFn(window.globalFn.pjaxComplete)
  })

  document.addEventListener('pjax:error', e => {
    if (e.request.status === 404) {
      const usePjax = true
      false
        ? (usePjax ? pjax.loadUrl('/404.html') : window.location.href = '/404.html')
        : window.location.href = e.request.responseURL
    }
  })
})()</script><script async data-pjax src="/"></script></div><!-- hexo injector body_end start --> <script data-pjax>if(document.getElementById('recent-posts') && (location.pathname ==='/'|| '/' ==='all')){
    var parent = document.getElementById('recent-posts');
    var child = '<div class="recent-post-item" style="width:100%;height: auto"><div id="catalog_magnet"><div class="magnet_item"><a class="magnet_link" href="https://www.sparklerain.top/categories/Prepare/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">📚 准备工作 (2)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://www.sparklerain.top/categories/Live/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">🐱 生活趣闻 (1)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://www.sparklerain.top/categories/Programming/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">👩‍💻 计算机编程 (7)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://www.sparklerain.top/categories/Study/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">📒 学习笔记 (8)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><a class="magnet_link_more"  href="https://www.sparklerain.top/categories" style="flex:1;text-align: center;margin-bottom: 10px;">查看更多...</a></div></div>';
    console.log('已挂载magnet')
    parent.insertAdjacentHTML("afterbegin",child)}
     </script><style>#catalog_magnet{flex-wrap: wrap;display: flex;width:100%;justify-content:space-between;padding: 10px 10px 0 10px;align-content: flex-start;}.magnet_item{flex-basis: calc(50% - 5px);background: #f2f2f2;margin-bottom: 10px;border-radius: 8px;transition: all 0.2s ease-in-out;}.magnet_item:hover{background: #b30070}.magnet_link_more{color:#555}.magnet_link{color:black}.magnet_link:hover{color:white}@media screen and (max-width: 600px) {.magnet_item {flex-basis: 100%;}}.magnet_link_context{display:flex;padding: 10px;font-size:16px;transition: all 0.2s ease-in-out;}.magnet_link_context:hover{padding: 10px 20px;}</style>
    <style></style><script data-pjax>
  function butterfly_swiper_injector_config(){
    var parent_div_git = document.getElementById('recent-posts');
    var item_html = '<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/c23efd5b/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/posts/linear_algebra.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-11-24</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/c23efd5b/&quot;);" href="javascript:void(0);" alt="">线性代数</a><div class="blog-slider__text">线性代数笔记</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/c23efd5b/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/1f59513d/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/posts/2025.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-12-24</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/1f59513d/&quot;);" href="javascript:void(0);" alt="">2025年度总结</a><div class="blog-slider__text">总结我的2025年</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/1f59513d/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/8d4b7ae1/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/posts/计算机组成原理.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-12-18</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/8d4b7ae1/&quot;);" href="javascript:void(0);" alt="">计算机组成原理</a><div class="blog-slider__text">计算机组成原理笔记</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/8d4b7ae1/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/3fb56f9d/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/posts/离散数学.avif" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-11-25</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/3fb56f9d/&quot;);" href="javascript:void(0);" alt="">离散数学</a><div class="blog-slider__text">离散数学笔记</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/3fb56f9d/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/4a17b156/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/posts/hello_world.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-11-14</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/4a17b156/&quot;);" href="javascript:void(0);" alt="">Hello World</a><div class="blog-slider__text">Hexo官方文档</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/4a17b156/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>';
    console.log('已挂载butterfly_swiper')
    parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  var elist = 'undefined'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_swiper_injector_config();
  }
  else if (epage === cpage){
    butterfly_swiper_injector_config();
  }
  </script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js"></script><!-- hexo injector body_end end --></body></html>